



Network Working Group                                           C. Papon
Internet-Draft                                                  C. Onete
Intended status: Informational   XLIM UMR CNRS 7252 - Limoges University
Expires: 30 August 2026                                 26 February 2026


Post-Quantum EDHOC - Initiator and Responder using signature and/or KEM
                      draft-papon-pq-edhoc-latest

Abstract

   This document specifies two extensions to the Ephemeral Diffie-
   Hellman over COSE (EDHOC).  These two protocol versions aim to
   provide quantum-resistance to the original EDHOC protocol, while
   reducing message-complexity with respect to parallel drafts.  The
   document defines: (1) a 3-message quantum-resistant EDHOC proposal
   when the Initiator knows the Responder; in this version, the
   Initiator authenticates using a signature, while the Responder uses a
   KEM; (2) a 3-or-4-message quantum-resistant EDHOC proposal, which
   proposes a tradeoff between message-complexity and computational
   overhead.

Discussion Venues

   This note is to be removed before publishing as an RFC.

   Source for this draft and an issue tracker can be found at
   https://github.com/clementpapon/draft-papon-pq-edhoc.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on 30 August 2026.

Copyright Notice

   Copyright (c) 2026 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents (https://trustee.ietf.org/
   license-info) in effect on the date of publication of this document.
   Please review these documents carefully, as they describe your rights
   and restrictions with respect to this document.  Code Components
   extracted from this document must include Revised BSD License text as
   described in Section 4.e of the Trust Legal Provisions and are
   provided without warranty as described in the Revised BSD License.

Table of Contents

   1.  Introduction
     1.1.  Terminology and Requirements Language
     1.2.  Definitions
       1.2.1.  KEMs (Key Encapsulation Mechanisms)
       1.2.2.  Digital Signature
   2.  Post-Quantum EDHOC when the Initiator knows the Responder
           (PQ-EDHOC-IKR)
     2.1.  Motivation
     2.2.  PQ-EDHOC-IKR protocol overview
       2.2.1.  PQ-EDHOC-IKR protocol description
   3.  Second protocol
   4.  Security Considerations
   5.  IANA Considerations
   6.  Acknowledgments
   7.  References
     7.1.  Normative References
     7.2.  Informative References
   Authors' Addresses

1.  Introduction

   This document aims to present new alternatives for rendering the
   Ephemeral Diffie-Hellman Over COSE (EDHOC) protocol quantum-
   resistant.  The main goal is to reduce the number of messages
   exchanged during the handshake, using a combination of KEMs and
   signatures, as well as Post-Quantum Cryptography (PQC) cipher suites,
   for secure key-exchange and authentication.

   In this draft we:

   *  propose, build on [I-D.pocero-authkem-ikr-edhoc], a version of
      quantum-resistant EDHOC where the Initiator knows the Responder,
      but in a scenario where the Initiator authenticates with a
      signature (ML-DSA) and the Responder with a KEM (ML-KEM).

   *  propose, building on [I-D.pocero-authkem-edhoc], a version of the
      protocol that requires, depending on the case, either only 3 or 4
      mandatory messages.  This second version reduces the message
      overhead, but comes at an additional computational overhead for
      (at least) one of the two parties.

   The two proposals in this draft can be viewed to extend (in the case
   of the first bullet-point) and respectively to provide an alternative
   (in the case of the second bullet-point) to the current proposal for
   quantum-resistant EDHOC.

1.1.  Terminology and Requirements Language

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in
   BCP 14 [RFC2119] [RFC8174] when, and only when, they appear in all
   capitals, as shown here.

   Readers are expected to be familiar with the terms and concepts
   described in EDHOC [RFC9528], CBOR [RFC8949], CBOR Sequences
   [RFC8742], COSE Structures and Processing [RFC9052] and COSE
   Algorithms [RFC9053].

1.2.  Definitions

1.2.1.  KEMs (Key Encapsulation Mechanisms)

   TODO

1.2.2.  Digital Signature

   TODO

2.  Post-Quantum EDHOC when the Initiator knows the Responder (PQ-EDHOC-
    IKR)

2.1.  Motivation

   In [I-D.pocero-authkem-ikr-edhoc], the authors adopt an EDHOC
   approach for use cases where the Initiator already knows the identity
   of the Responder, in a post-quantum version using ephemeral and
   static KEMs for authentication.  The Initiator, knowing the long-term
   public key of the Responder, can derive the shared-secret (ss_R) and
   compute a key, then encrypt part of the first message.  It can thus
   send its identity directly and securely authenticate itself, since
   only the Responder with its long-term secret key can decrypt the
   first message.  Knowing the Initiator's identity, the Responder can
   derive the second shared-secret (ss_I) and continue the key
   derivation schedule.  Sending the encrypted second message allows it
   to securely confirm its identity to the Initiator.

   The key motivation behind our current proposal is a desire to reduce
   the message-complexity of quantum-resistant EDHOC.  We propose an
   extension to draft proposal [I-D.pocero-authkem-ikr-edhoc], which
   allows the Initiator and Responder to authenticate using different
   mechanisms -- much as in the original EDHOC.  In particular, while
   the Responder still authenticates using a KEM, in our proposal the
   Initiator will use a signature.

   This approach comes with the following benefit: there is no need to
   partially encrypt the first message.  Instead, during the third
   message, the Initiator calculates a MAC and signs it.  Upon receiving
   the encrypted third message, the Responder, after decryption,
   authenticates the Initiator in the usual EDHOC manner.

2.2.  PQ-EDHOC-IKR protocol overview

2.2.1.  PQ-EDHOC-IKR protocol description

   We present here a high-level description of our PQ-EDHOC-IKR where
   the Initiator authenticates with a signature and the Responder with a
   KEM.

     I                                                         R
    ---                                                       ---
     |   METHOD, SUITES_I, kem.pk_eph, kem.ct_R, C_I, EAD_1    |
     +--------------------------------------------------------->
     |                        message_1                        |
     |                                                         |
     |  kem.ct_eph, Enc(KEYSTREAM_2, ID_CRED_R, MAC_2, EAD_2)  |
     <---------------------------------------------------------+
     |                        message_2                        |
     |                                                         |
     |           AEAD(ID_CRED_I, Signature_3, EAD_3)           |
     +--------------------------------------------------------->
     |                        message_3                        |
     |                                                         |
     |                       AEAD(EAD_4)                       |
     <- - - - - - - - - - - - - - - - - - - - - - - - - - - - -+
     |                        message_4                        |

   Figure 1: PK-EDHOC-IKR (I sign, R kem) message flow.

2.2.1.1.  Formatting and sending message_1

   As in the usual EDHOC protocol, the first message (message_1)
   consists of:

   *  METHOD --> as specified in [RFC9528] it is an integer specifying
      the authentication method the Initiator wants to use;

   *  SUITES_I --> it consists of an ordered set of algorithms supported
      by the Initiator and formatted as specified in [RFC9528];

   *  C_I (and also as C_R, which will appears later) --> the Connection
      Identifiers chosen by the Initiator (C_I) and by the Responder
      (C_R) as specified in [RFC9528];

   *  EAD_1 (and also EAD_2, EAD_3 and EAD_4, which will appear later)
      -> External Authorization Data, respectively included in
      message_1, message_2, message_3 (and optionally) message_4, and
      formatted as specified in [RFC9528];

   *  kem.pk_eph --> the Ephemeral KEM public key generated by the
      Initiator;

   *  kem.ct_R --> based on the Responder long-term KEM public key, the
      Initiator computes ss_R and kem.ct_R with the KEM.Encapsulation
      algorithm.  He keeps secret ss_R to compute, later, PRK_3e2m, and
      sends kem.ct_R to the Responder.

2.2.1.2.  Processing message_1, formatting and sending message_2

   On the reception of the first message, the Responder first recovers
   ss_R thanks to his long-term KEM secret key kem.sk_R and kem.ct_R,
   using the KEM.Decapsulation algorithm (if the decapsulation process
   fails, he aborts).  He then proceeds as in the original EDHOC
   protocol with elements METHOD, SUITES_I, C_I and EAD_1.  Finally,
   using kem.pk_eph and the KEM.Encapsulation algorithm, he computes the
   ephemeral ciphertext kem.ct_eph and the ephemeral shared-secret
   ss_eph.

   The Responder select its Connection Identifier C_R as specified in
   [RFC9528].  He then computes:

   *  TH_2 = H(kem.ct_eph, H(message_1));

   *  PRK_2e = EDHOC_Extract(TH_2, ss_eph) --> the salt SHALL be TH_2
      and the IKM SHALL be the ephemeral shared-secret ss_eph.

   And also, as in [RFC9528]:

   *  KEYSTREAM_2 = EDHOC_KDF(PRK_2e, 0, TH_2, plaintext_length);

   *  SALT_3e2m = EDHOC_KDF(PRK_2e, 1, TH_2, hash_length).

   Compared to [RFC9528], the computation of PRK_3e2m is modified as
   follows :

   *  PRK_3e2m = EDHOC_Extract(SALT_3e2m, ss_R).

   The Responder now computes MAC_2 and assembles PLAINTEXT_2:

   *  MAC_2 = EDHOC_KDF(PRK_3e2m, 2, C_R, ID_CRED_R, TH_2, EAD_2,
      mac_length_2);

   *  PLAINTEXT_2 = (C_R, ID_CRED_R, MAC_2, EAD_2).

   So the second message consists of:

   *  kem.ct_eph --> the ephemeral ciphertext obtained with kem.pk_eph;

   *  CIPHERTEXT_2 = PLAINTEXT_2 XOR KEYSTREAM_2.

2.2.1.3.  Processing message_2, formatting and sending message_3.

   On reception of the second message, the Initiator, using kemp.ct_eph,
   can compute the ephemeral shared-secretss_eph.  As the Responder did,
   he computesTH_2,PRK_2eandKEYSTREAM_2.  He can now decipher and
   retrieve :PLAINTEXT_2 = CIPHERTEXT_2 XOR KEYSTREAM_2`.

   Thanks to ID_CRED_R, the Initiator verifies the validity of the long-
   term KEM public key of the Responder, kemp.pk_R, and computes
   SALT_3e2mand PRK_3e2m, using the shared-secret ss_Rhe generates at
   the beginning of the exchange.

   At this point the Initiator is abable to authenticate the Responder
   (at least, make sure he is talking to the endpoint he hopes to talk
   to).  For that, he computes, as the Responder did, the MAC MAC_2.  If
   it machtes with the one he received, then he properly authenticated
   the Responder.  Otherwise he aborts.

   It is now up to the Initiator to authenticate himself.  To do so, the
   Initiator computes the following elements:

   *  TH_3 = H(TH_2, PLAINTEXT_2, ID_CRED_R);

   *  K_3 = EDHOC_KDF(PRK_3e2m, 3, TH_3, key_length);

   *  IV_3 = EDHOC_KDF(PRK_3e2m, 4, TH_3, iv_length);

   *  'MAC_3 = EDHOC_KDF(PRK_3e2m, 6, ID_CRED_I, TH_3, EAD_3,
      mac_length_3)`.

   In this version of the protocol, the Initiator authenticates itself
   to the Responder with a signature:

   *  SIGNATURE_3 = DS.Sign(sign.sk_I, (ID_CRED_I, TH_3, EAD_3, MAC_3,
      sign_length))

   where sign.sk_Iis the long-term signing private key of the Initiator.

   Setting PLAINTEXT_3 = (ID_CRED_I, SIGNATURE_3, EAD_3), the Initiator
   ciphers PLAINTEXT_3 with the AEAD encryption algorithm negociated in
   SUITES_I.

2.2.1.4.  Processing message_3

   On reception of message_3, the Responder computes TH_3, K_3, and IV_3
   as the Initiator did, and deciphers CIPHERTEXT_3 with the AEAD
   decryption algorithm.  With PLAINTEXT_3, he can compute MAC_3on his
   side, and verify the signature:

   *  DS.Verify(sign.pk_I, (ID_CRED_I, TH_3, EAD_3, MAC_3, sign_length))

   where sign.pk_I is the long-term signing public key of the Initiator.
   If the verification algorithm returns 1, the Responder properly
   authenticated the Initiator.  Otherwise he aborts.

2.2.1.5.  Optionally formatting, sending and recieving message_4

   If the Responder decides of a fourth mandatory message, he then
   computes the following elements:

   *  TH_4 = H(TH_3, PLAINTEXT_3, ID_CRED_I);

   *  K_4 = EDHOC_KDF(PRK_4e3m, 8, TH_4, key_length);

   *  IV_4 = EDHOC_KDF(PRK_4e3m, 9, TH_4, iv_length).

   Using the AEAD encryption algorithm, he ciphers PLAINTEXT_4 =
   EAD_4and sends it to the Initiator.  The later computes TH_4, K_4,
   IV_4, and deciphers CIPHERTEXT_4 thanks to the AEAD decryption
   algorithm.

2.2.1.6.  Computing the session key PRK_out

   It doesn't matter if there is a fourth mandatory message, in any
   case, both the Initiator and the Responder, in order to compute the
   key PRK_out, have to calcule the fourth transcript hash:

   *  TH_4 = H(TH_3, PLAINTEXT_3, ID_CRED_I).

   With that element, using the EDHOC_KDF, they both obtain:

   *  `PRK_out = EDHOC_KDF(PRK_3e2m, 7, TH_4, hash_length)'

   which is the desired session key, and the authentication process is
   fully achieved.

3.  Second protocol

   Our second idea is to propose a tradeoff, allowing for a reduced
   number of messages in the quantum-resistant EDHOC handshake, which
   come at a slightly higher computational overhead.

4.  Security Considerations

   TODO Security

5.  IANA Considerations

   This document has no IANA actions.

6.  Acknowledgments

   TODO acknowledge.

7.  References

7.1.  Normative References

   [I-D.pocero-authkem-edhoc]
              Fraile, L. P., Koulamas, C., Fournaris, A. P., and E.
              Haleplidis, "KEM-based Authentication for EDHOC", Work in
              Progress, Internet-Draft, draft-pocero-authkem-edhoc-01,
              24 October 2025, <https://datatracker.ietf.org/doc/html/
              draft-pocero-authkem-edhoc-01>.

   [I-D.pocero-authkem-ikr-edhoc]
              Fraile, L. P., Koulamas, C., Fournaris, A. P., and E.
              Haleplidis, "KEM-based Authentication for EDHOC in
              Initiator-Known Responder (IKR) Scenarios", Work in
              Progress, Internet-Draft, draft-pocero-authkem-ikr-edhoc-
              01, 20 January 2026,
              <https://datatracker.ietf.org/doc/html/draft-pocero-
              authkem-ikr-edhoc-01>.

   [I-D.spm-lake-pqsuites]
              Selander, G. and J. P. Mattsson, "Quantum-Resistant Cipher
              Suites for EDHOC", Work in Progress, Internet-Draft,
              draft-spm-lake-pqsuites-01, 20 October 2025,
              <https://datatracker.ietf.org/doc/html/draft-spm-lake-
              pqsuites-01>.

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/rfc/rfc2119>.

   [RFC5116]  McGrew, D., "An Interface and Algorithms for Authenticated
              Encryption", RFC 5116, DOI 10.17487/RFC5116, January 2008,
              <https://www.rfc-editor.org/rfc/rfc5116>.

   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC
              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,
              May 2017, <https://www.rfc-editor.org/rfc/rfc8174>.

   [RFC8392]  Jones, M., Wahlstroem, E., Erdtman, S., and H. Tschofenig,
              "CBOR Web Token (CWT)", RFC 8392, DOI 10.17487/RFC8392,
              May 2018, <https://www.rfc-editor.org/rfc/rfc8392>.

   [RFC8742]  Bormann, C., "Concise Binary Object Representation (CBOR)
              Sequences", RFC 8742, DOI 10.17487/RFC8742, February 2020,
              <https://www.rfc-editor.org/rfc/rfc8742>.

   [RFC8949]  Bormann, C. and P. Hoffman, "Concise Binary Object
              Representation (CBOR)", STD 94, RFC 8949,
              DOI 10.17487/RFC8949, December 2020,
              <https://www.rfc-editor.org/rfc/rfc8949>.

   [RFC9052]  Schaad, J., "CBOR Object Signing and Encryption (COSE):
              Structures and Process", STD 96, RFC 9052,
              DOI 10.17487/RFC9052, August 2022,
              <https://www.rfc-editor.org/rfc/rfc9052>.

   [RFC9360]  Schaad, J., "CBOR Object Signing and Encryption (COSE):
              Header Parameters for Carrying and Referencing X.509
              Certificates", RFC 9360, DOI 10.17487/RFC9360, February
              2023, <https://www.rfc-editor.org/rfc/rfc9360>.

   [RFC9528]  Selander, G., Preuß Mattsson, J., and F. Palombini,
              "Ephemeral Diffie-Hellman Over COSE (EDHOC)", RFC 9528,
              DOI 10.17487/RFC9528, March 2024,
              <https://www.rfc-editor.org/rfc/rfc9528>.

7.2.  Informative References

   [RFC9053]  Schaad, J., "CBOR Object Signing and Encryption (COSE):
              Initial Algorithms", RFC 9053, DOI 10.17487/RFC9053,
              August 2022, <https://www.rfc-editor.org/rfc/rfc9053>.

   [RFC9794]  Driscoll, F., Parsons, M., and B. Hale, "Terminology for
              Post-Quantum Traditional Hybrid Schemes", RFC 9794,
              DOI 10.17487/RFC9794, June 2025,
              <https://www.rfc-editor.org/rfc/rfc9794>.

Authors' Addresses

   Clément Papon
   XLIM UMR CNRS 7252 - Limoges University
   Email: clement.papon@unilim.fr


   Cristina Onete
   XLIM UMR CNRS 7252 - Limoges University
   Email: maria-cristina.onete@unilim.fr
