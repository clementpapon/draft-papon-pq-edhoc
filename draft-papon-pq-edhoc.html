<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Post-Quantum EDHOC - Initiator and Responder using signature and/or KEM</title>
<meta content="Clément Papon" name="author">
<meta content="Cristina Onete" name="author">
<meta content="
       This document specifies two extensions to the Ephemeral Diffie-Hellman over COSE (EDHOC). These two protocol versions aim to provide quantum-resistance to the original EDHOC protocol, while reducing message-complexity with respect to parallel drafts. The document defines: (1) a 3-message quantum-resistant EDHOC proposal when the Initiator knows the Responder; in this version, the Initiator authenticates using a signature, while the Responder uses a KEM; (2) a 3-or-4-message quantum-resistant EDHOC proposal, which proposes a tradeoff between message-complexity and computational overhead. 
    " name="description">
<meta content="xml2rfc 3.31.0" name="generator">
<meta content="EDHOC" name="keyword">
<meta content="Post-Quantum" name="keyword">
<meta content="Authentication Key Exchange" name="keyword">
<meta content="draft-papon-pq-edhoc-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.31.0
    Python 3.12.12
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.2.1
    Jinja2 3.1.6
    lxml 6.0.2
    platformdirs 4.5.1
    pycountry 24.6.1
    PyYAML 6.0.3
    requests 2.32.5
    wcwidth 0.3.0
-->
<link href="draft-papon-pq-edhoc.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
  border-left: 2px var(--pilcrow-strong) solid;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow, a.pilcrow:focus {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">PQ-EDHOC - Sign and KEM</td>
<td class="right">February 2026</td>
</tr></thead>
<tfoot><tr>
<td class="left">Papon &amp; Onete</td>
<td class="center">Expires 30 August 2026</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-papon-pq-edhoc-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2026-02-26" class="published">26 February 2026</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2026-08-30">30 August 2026</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">C. Papon</div>
<div class="org">XLIM UMR CNRS 7252 - Limoges University</div>
</div>
<div class="author">
      <div class="author-name">C. Onete</div>
<div class="org">XLIM UMR CNRS 7252 - Limoges University</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Post-Quantum EDHOC - Initiator and Responder using signature and/or KEM</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document specifies two extensions to the Ephemeral Diffie-Hellman over COSE (EDHOC). These two protocol versions aim to provide quantum-resistance to the original EDHOC protocol, while reducing message-complexity with respect to parallel drafts. The document defines: (1) a 3-message quantum-resistant EDHOC proposal when the Initiator knows the Responder; in this version, the Initiator authenticates using a signature, while the Responder uses a KEM; (2) a 3-or-4-message quantum-resistant EDHOC proposal, which proposes a tradeoff between message-complexity and computational overhead.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Source for this draft and an issue tracker can be found at
    <span><a href="https://github.com/clementpapon/draft-papon-pq-edhoc">https://github.com/clementpapon/draft-papon-pq-edhoc</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 30 August 2026.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2026 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-terminology-and-requirement" class="internal xref">Terminology and Requirements Language</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-definitions" class="internal xref">Definitions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2.2.1">
                    <p id="section-toc.1-1.1.2.2.2.1.1" class="keepWithNext"><a href="#section-1.2.1" class="auto internal xref">1.2.1</a>.  <a href="#name-kems-key-encapsulation-mech" class="internal xref">KEMs (Key Encapsulation Mechanisms)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2.2.2">
                    <p id="section-toc.1-1.1.2.2.2.2.1" class="keepWithNext"><a href="#section-1.2.2" class="auto internal xref">1.2.2</a>.  <a href="#name-digital-signature" class="internal xref">Digital Signature</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-post-quantum-edhoc-when-the" class="internal xref">Post-Quantum EDHOC when the Initiator knows the Responder (PQ-EDHOC-IKR)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-motivation" class="internal xref">Motivation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-pq-edhoc-ikr-protocol-overv" class="internal xref">PQ-EDHOC-IKR protocol overview</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.1">
                    <p id="section-toc.1-1.2.2.2.2.1.1"><a href="#section-2.2.1" class="auto internal xref">2.2.1</a>.  <a href="#name-pq-edhoc-ikr-protocol-descr" class="internal xref">PQ-EDHOC-IKR protocol description</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.2">
                    <p id="section-toc.1-1.2.2.2.2.2.1"><a href="#section-2.2.2" class="auto internal xref">2.2.2</a>.  <a href="#name-key-derivation-schedule" class="internal xref">Key Derivation Schedule</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.3">
                    <p id="section-toc.1-1.2.2.2.2.3.1"><a href="#section-2.2.3" class="auto internal xref">2.2.3</a>.  <a href="#name-additional-explanations" class="internal xref">Additional explanations</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="auto internal xref">2.3</a>.  <a href="#name-analysis" class="internal xref">Analysis</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-kem-sign-authentication-for" class="internal xref">KEM &amp; Sign Authentication for Post-Quantum EDHOC</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-motivation-2" class="internal xref">Motivation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-first-case-initiator-signs-" class="internal xref">First case: Initiator signs, Responder KEM and signs</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="auto internal xref">3.2.1</a>.  <a href="#name-protocol-overview" class="internal xref">Protocol overview</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.2">
                    <p id="section-toc.1-1.3.2.2.2.2.1"><a href="#section-3.2.2" class="auto internal xref">3.2.2</a>.  <a href="#name-protocol-description" class="internal xref">Protocol description</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.3">
                    <p id="section-toc.1-1.3.2.2.2.3.1"><a href="#section-3.2.3" class="auto internal xref">3.2.3</a>.  <a href="#name-associated-key-derivation-s" class="internal xref">Associated key derivation schedule</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.4">
                    <p id="section-toc.1-1.3.2.2.2.4.1"><a href="#section-3.2.4" class="auto internal xref">3.2.4</a>.  <a href="#name-additional-explanations-2" class="internal xref">Additional explanations</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.5">
                    <p id="section-toc.1-1.3.2.2.2.5.1"><a href="#section-3.2.5" class="auto internal xref">3.2.5</a>.  <a href="#name-analysis-2" class="internal xref">Analysis</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-second-case-initiator-kem-a" class="internal xref">Second case: Initiator KEM and signs, Responder signs</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.1">
                    <p id="section-toc.1-1.3.2.3.2.1.1"><a href="#section-3.3.1" class="auto internal xref">3.3.1</a>.  <a href="#name-protocol-overview-2" class="internal xref">Protocol overview</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.2">
                    <p id="section-toc.1-1.3.2.3.2.2.1"><a href="#section-3.3.2" class="auto internal xref">3.3.2</a>.  <a href="#name-protocol-description-2" class="internal xref">Protocol description</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.3">
                    <p id="section-toc.1-1.3.2.3.2.3.1"><a href="#section-3.3.3" class="auto internal xref">3.3.3</a>.  <a href="#name-associated-key-derivation-sc" class="internal xref">Associated key derivation schedule</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.4">
                    <p id="section-toc.1-1.3.2.3.2.4.1"><a href="#section-3.3.4" class="auto internal xref">3.3.4</a>.  <a href="#name-additional-explanations-3" class="internal xref">Additional explanations</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.5">
                    <p id="section-toc.1-1.3.2.3.2.5.1"><a href="#section-3.3.5" class="auto internal xref">3.3.5</a>.  <a href="#name-analysis-3" class="internal xref">Analysis</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-third-case-initiator-and-re" class="internal xref">Third case: Initiator and Responder KEM and sign - version 1</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.1">
                    <p id="section-toc.1-1.3.2.4.2.1.1"><a href="#section-3.4.1" class="auto internal xref">3.4.1</a>.  <a href="#name-protocol-overview-3" class="internal xref">Protocol overview</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.2">
                    <p id="section-toc.1-1.3.2.4.2.2.1"><a href="#section-3.4.2" class="auto internal xref">3.4.2</a>.  <a href="#name-protocol-description-3" class="internal xref">Protocol description</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.3">
                    <p id="section-toc.1-1.3.2.4.2.3.1"><a href="#section-3.4.3" class="auto internal xref">3.4.3</a>.  <a href="#name-associated-key-derivation-sch" class="internal xref">Associated key derivation schedule</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.4">
                    <p id="section-toc.1-1.3.2.4.2.4.1"><a href="#section-3.4.4" class="auto internal xref">3.4.4</a>.  <a href="#name-additional-explanations-4" class="internal xref">Additional explanations</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.5">
                    <p id="section-toc.1-1.3.2.4.2.5.1"><a href="#section-3.4.5" class="auto internal xref">3.4.5</a>.  <a href="#name-analysis-4" class="internal xref">Analysis</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="auto internal xref">3.5</a>.  <a href="#name-third-case-initiator-and-res" class="internal xref">Third case: Initiator and Responder KEM and sign - version 2</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5.2.1">
                    <p id="section-toc.1-1.3.2.5.2.1.1"><a href="#section-3.5.1" class="auto internal xref">3.5.1</a>.  <a href="#name-protocol-overview-4" class="internal xref">Protocol overview</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5.2.2">
                    <p id="section-toc.1-1.3.2.5.2.2.1"><a href="#section-3.5.2" class="auto internal xref">3.5.2</a>.  <a href="#name-protocol-description-4" class="internal xref">Protocol description</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5.2.3">
                    <p id="section-toc.1-1.3.2.5.2.3.1"><a href="#section-3.5.3" class="auto internal xref">3.5.3</a>.  <a href="#name-associated-key-derivation-sche" class="internal xref">Associated key derivation schedule</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5.2.4">
                    <p id="section-toc.1-1.3.2.5.2.4.1"><a href="#section-3.5.4" class="auto internal xref">3.5.4</a>.  <a href="#name-additional-explanations-5" class="internal xref">Additional explanations</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5.2.5">
                    <p id="section-toc.1-1.3.2.5.2.5.1"><a href="#section-3.5.5" class="auto internal xref">3.5.5</a>.  <a href="#name-analysis-5" class="internal xref">Analysis</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-security-considerations-of-" class="internal xref">Security Considerations of PQ-EDHOC-IKR (I Signs - R KEM)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-security-considerations-of-p" class="internal xref">Security Considerations of PQ-EDHOC KEM and/or Sign</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="auto internal xref">4.2.1</a>.  <a href="#name-initiator-signs-and-respond" class="internal xref">Initiator signs and Responder KEM &amp; Signs</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a href="#section-4.2.2" class="auto internal xref">4.2.2</a>.  <a href="#name-initiator-kem-signs-and-res" class="internal xref">Initiator KEM &amp; Signs and Responder Signs</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.3">
                    <p id="section-toc.1-1.4.2.2.2.3.1"><a href="#section-4.2.3" class="auto internal xref">4.2.3</a>.  <a href="#name-initiator-kem-signs-and-resp" class="internal xref">Initiator KEM &amp; Signs and Responder KEM</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.4">
                    <p id="section-toc.1-1.4.2.2.2.4.1"><a href="#section-4.2.4" class="auto internal xref">4.2.4</a>.  <a href="#name-initiator-and-responder-kem" class="internal xref">Initiator and Responder KEM &amp; Signs</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This document aims to present new alternatives for rendering the Ephemeral Diffie-Hellman Over COSE (EDHOC) protocol quantum-resistant. The main goal is to reduce the number of messages exchanged during the handshake, using a combination of KEMs and signatures, as well as Post-Quantum Cryptography (PQC) cipher suites, for secure key-exchange and authentication.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">In this draft we:<a href="#section-1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-3.1">
          <p id="section-1-3.1.1">propose, build on <span>[<a href="#I-D.pocero-authkem-ikr-edhoc" class="cite xref">I-D.pocero-authkem-ikr-edhoc</a>]</span>, a version of quantum-resistant EDHOC where the Initiator knows the Responder, but in a scenario where the Initiator authenticates with a signature (ML-DSA) and the Responder with a KEM (ML-KEM).<a href="#section-1-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-3.2">
          <p id="section-1-3.2.1">propose, building on <span>[<a href="#I-D.pocero-authkem-edhoc" class="cite xref">I-D.pocero-authkem-edhoc</a>]</span>, a version of the protocol that requires, depending on the case, either only 3 or 4 mandatory messages. This second version reduces the message overhead, but comes at an additional computational overhead for (at least) one of the two parties.<a href="#section-1-3.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-1-4">The two proposals in this draft can be viewed to extend (in the case of the first bullet-point) and respectively to provide an alternative (in the case of the second bullet-point) to the current proposal for quantum-resistant EDHOC.<a href="#section-1-4" class="pilcrow">¶</a></p>
<div id="terminology-and-requirements-language">
<section id="section-1.1">
        <h3 id="name-terminology-and-requirement">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-terminology-and-requirement" class="section-name selfRef">Terminology and Requirements Language</a>
        </h3>
<p id="section-1.1-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">Readers are expected to be familiar with the terms and concepts described in EDHOC <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>, CBOR <span>[<a href="#RFC8949" class="cite xref">RFC8949</a>]</span>, CBOR Sequences <span>[<a href="#RFC8742" class="cite xref">RFC8742</a>]</span>, COSE Structures and Processing <span>[<a href="#RFC9052" class="cite xref">RFC9052</a>]</span> and COSE Algorithms <span>[<a href="#RFC9053" class="cite xref">RFC9053</a>]</span>.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="definitions">
<section id="section-1.2">
        <h3 id="name-definitions">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-definitions" class="section-name selfRef">Definitions</a>
        </h3>
<div id="kems-key-encapsulation-mechanisms">
<section id="section-1.2.1">
          <h4 id="name-kems-key-encapsulation-mech">
<a href="#section-1.2.1" class="section-number selfRef">1.2.1. </a><a href="#name-kems-key-encapsulation-mech" class="section-name selfRef">KEMs (Key Encapsulation Mechanisms)</a>
          </h4>
<p id="section-1.2.1-1">A Key Encapsulation Mechanism (KEM) consists of three algorithms:<a href="#section-1.2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.2.1-2.1">
              <p id="section-1.2.1-2.1.1"><code>KEM.KeyGen</code>: a probabilistic key generation algorithm, which takes as input a security parameter <code>k</code> and outputs a key pair <code>(kem.sk, kem.pk)</code>, where <code>kem.sk</code> is secret and <code>kem.pk</code> is public.<a href="#section-1.2.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.2.1-2.2">
              <p id="section-1.2.1-2.2.1"><code>KEM.Encapsulation</code>: a probabilistic encapsulation algorithm, which takes as input a KEM public key <code>kem.pk</code>, and generates a pair <code>(ss, kem.ct)</code>, where <code>ss</code> is the shared-secret and <code>kem.ct</code> is a ciphertext.<a href="#section-1.2.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.2.1-2.3">
              <p id="section-1.2.1-2.3.1"><code>KEM.Decapsulation</code>: a deterministic decapsulation algorithm, which takes as input a KEM secret key <code>kem.sk</code> and a KEM ciphertext <code>kem.ct</code>, and outputs the shared-secret <code>ss</code> (associated to <code>kem.ct</code>).<a href="#section-1.2.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-1.2.1-3">In practice, if Alice and Bob use a KEM, Alice generates the public and private keys, sends the public key to Bob, who generates the shared-secret and ciphertext. He then returns the latter to Alice, who can subsequently recover the same shared-secret using her private key and the ciphertext.<a href="#section-1.2.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="digital-signature">
<section id="section-1.2.2">
          <h4 id="name-digital-signature">
<a href="#section-1.2.2" class="section-number selfRef">1.2.2. </a><a href="#name-digital-signature" class="section-name selfRef">Digital Signature</a>
          </h4>
<p id="section-1.2.2-1">A Digital Signature (DS) scheme consists of three algorithms:<a href="#section-1.2.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.2.2-2.1">
              <p id="section-1.2.2-2.1.1"><code>DS.KeyGen</code>: a probabilistic key generation algorithm, which takes as input a security parameter <code>k</code> and outputs a key pair <code>(sign.sk, sign.pk)</code>, where <code>sign.sk</code> is secret and <code>sign.pk</code> is public.<a href="#section-1.2.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.2.2-2.2">
              <p id="section-1.2.2-2.2.1"><code>DS.Sign</code>: a probabilistic algorithm, which takes as input a signing secret key <code>sign.sk</code> and a message <code>m</code>, and generates a signature <code>s</code>.<a href="#section-1.2.2-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.2.2-2.3">
              <p id="section-1.2.2-2.3.1"><code>DS.Verify</code>: a deterministic algorithm, which takes as input a signing public key <code>sign.pk</code>, a message <code>m</code> and a signature <code>s</code>, and outputs <code>1</code> if the signature is valid for the message, and <code>0</code> otherwise.<a href="#section-1.2.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-1.2.2-3">In practice, if Alice and Bob use a DS scheme, Alice generates the public and private keys, and sends the public key to Bob. Later, Alice sends a message together with a signature to Bob. Bob can then verify the validity of the signature on the message under the public key.<a href="#section-1.2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="post-quantum-edhoc-when-the-initiator-knows-the-responder-pq-edhoc-ikr">
<section id="section-2">
      <h2 id="name-post-quantum-edhoc-when-the">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-post-quantum-edhoc-when-the" class="section-name selfRef">Post-Quantum EDHOC when the Initiator knows the Responder (PQ-EDHOC-IKR)</a>
      </h2>
<div id="motivation">
<section id="section-2.1">
        <h3 id="name-motivation">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-motivation" class="section-name selfRef">Motivation</a>
        </h3>
<p id="section-2.1-1">In <span>[<a href="#I-D.pocero-authkem-ikr-edhoc" class="cite xref">I-D.pocero-authkem-ikr-edhoc</a>]</span>, the authors adopt an EDHOC approach for use cases where the Initiator already knows the identity of the Responder, in a post-quantum version using ephemeral and static KEMs for authentication. The Initiator, knowing the long-term public key of the Responder, can derive the shared-secret (ss_R) and compute a key, then encrypt part of the first message. It can thus send its identity directly and securely authenticate himself, since only the Responder with its long-term secret key can decrypt the first message. Knowing the Initiator's identity, the Responder can derive the second shared-secret (ss_I) and continue the key derivation schedule. Sending the encrypted second message allows it to securely confirm its identity to the Initiator.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">The key motivation behind our current proposal is a desire to reduce the message-complexity of quantum-resistant EDHOC. We propose an extension to draft proposal <span>[<a href="#I-D.pocero-authkem-ikr-edhoc" class="cite xref">I-D.pocero-authkem-ikr-edhoc</a>]</span>, which allows the Initiator and Responder to authenticate using different mechanisms -- much as in the original EDHOC. In particular, while the Responder still authenticates using a KEM, in our proposal the Initiator will use a signature.<a href="#section-2.1-2" class="pilcrow">¶</a></p>
<p id="section-2.1-3">This approach comes with the following benefit: there is no need to partially encrypt the first message. Instead, during the third message, the Initiator calculates a MAC and signs it. Upon receiving the encrypted third message, the Responder, after decryption, authenticates the Initiator in the usual EDHOC manner.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="pq-edhoc-ikr-protocol-overview">
<section id="section-2.2">
        <h3 id="name-pq-edhoc-ikr-protocol-overv">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-pq-edhoc-ikr-protocol-overv" class="section-name selfRef">PQ-EDHOC-IKR protocol overview</a>
        </h3>
<div id="pq-edhoc-ikr-protocol-description">
<section id="section-2.2.1">
          <h4 id="name-pq-edhoc-ikr-protocol-descr">
<a href="#section-2.2.1" class="section-number selfRef">2.2.1. </a><a href="#name-pq-edhoc-ikr-protocol-descr" class="section-name selfRef">PQ-EDHOC-IKR protocol description</a>
          </h4>
<p id="section-2.2.1-1">We present here a high-level description of our PQ-EDHOC-IKR where the Initiator authenticates with a signature and the Responder with a KEM.<a href="#section-2.2.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.1-2">
<pre>
  I                                                         R
 ---                                                       ---
  |   METHOD, SUITES_I, kem.pk_eph, kem.ct_R, C_I, EAD_1    |
  +---------------------------------------------------------&gt;
  |                        message_1                        |
  |                                                         |
  |  kem.ct_eph, Enc(KEYSTREAM_2, ID_CRED_R, MAC_2, EAD_2)  |
  &lt;---------------------------------------------------------+
  |                        message_2                        |
  |                                                         |
  |           AEAD(ID_CRED_I, Signature_3, EAD_3)           |
  +---------------------------------------------------------&gt;
  |                        message_3                        |
  |                                                         |
  |                       AEAD(EAD_4)                       |
  &lt;- - - - - - - - - - - - - - - - - - - - - - - - - - - - -+
  |                        message_4                        |
</pre><a href="#section-2.2.1-2" class="pilcrow">¶</a>
</div>
<p id="section-2.2.1-3">Figure 1: PQ-EDHOC-IKR (I sign, R kem) message flow.<a href="#section-2.2.1-3" class="pilcrow">¶</a></p>
<div id="formatting-and-sending-message1">
<section id="section-2.2.1.1">
            <h5 id="name-formatting-and-sending-mess">
<a href="#section-2.2.1.1" class="section-number selfRef">2.2.1.1. </a><a href="#name-formatting-and-sending-mess" class="section-name selfRef">Formatting and sending <code>message_1</code></a>
            </h5>
<p id="section-2.2.1.1-1">As in the usual EDHOC protocol, the first message (<code>message_1</code>) consists of:<a href="#section-2.2.1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.1.1-2.1">
                <p id="section-2.2.1.1-2.1.1"><code>METHOD</code> --&gt; as specified in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span> it is an integer specifying the authentication method the Initiator wants to use;<a href="#section-2.2.1.1-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.1.1-2.2">
                <p id="section-2.2.1.1-2.2.1"><code>SUITES_I</code> --&gt; it consists of an ordered set of algorithms supported by the Initiator and formatted as specified in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>;<a href="#section-2.2.1.1-2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.1.1-2.3">
                <p id="section-2.2.1.1-2.3.1"><code>C_I</code> (and also as <code>C_R</code>, which will appears later) --&gt; the Connection Identifiers chosen by the Initiator (C_I) and by the Responder (<code>C_R</code>) as specified in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>;<a href="#section-2.2.1.1-2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.1.1-2.4">
                <p id="section-2.2.1.1-2.4.1"><code>EAD_1</code> (and also <code>EAD_2</code>, <code>EAD_3</code> and <code>EAD_4</code>, which will appear later) -&gt; External Authorization Data, respectively included in <code>message_1</code>, <code>message_2</code>, <code>message_3</code> (and optionally) <code>message_4</code>, and formatted as specified in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>;<a href="#section-2.2.1.1-2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.1.1-2.5">
                <p id="section-2.2.1.1-2.5.1"><code>kem.pk_eph</code> --&gt; the Ephemeral KEM public key generated by the Initiator;<a href="#section-2.2.1.1-2.5.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.1.1-2.6">
                <p id="section-2.2.1.1-2.6.1"><code>kem.ct_R</code> --&gt; based on the Responder long-term KEM public key, the Initiator computes <code>ss_R</code> and <code>kem.ct_R</code> with the KEM.Encapsulation algorithm. He keeps secret <code>ss_R</code> to compute, later, <code>PRK_3e2m</code>, and sends <code>kem.ct_R</code> to the Responder.<a href="#section-2.2.1.1-2.6.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
<div id="processing-message1-formatting-and-sending-message2">
<section id="section-2.2.1.2">
            <h5 id="name-processing-message_1-format">
<a href="#section-2.2.1.2" class="section-number selfRef">2.2.1.2. </a><a href="#name-processing-message_1-format" class="section-name selfRef">Processing <code>message_1</code>, formatting and sending <code>message_2</code></a>
            </h5>
<p id="section-2.2.1.2-1">On the reception of the first message, the Responder first recovers <code>ss_R</code> thanks to his long-term KEM secret key <code>kem.sk_R</code> and <code>kem.ct_R</code>, using the <code>KEM.Decapsulation</code> algorithm (if the decapsulation process fails, he aborts). He then proceeds as in the original EDHOC protocol with elements <code>METHOD</code>, <code>SUITES_I</code>, <code>C_I</code> and <code>EAD_1</code>. Finally, using <code>kem.pk_eph</code> and the <code>KEM.Encapsulation</code> algorithm, he computes the ephemeral ciphertext <code>kem.ct_eph</code> and the ephemeral shared-secret <code>ss_eph</code>.<a href="#section-2.2.1.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2.1.2-2">The Responder selects its Connection Identifier <code>C_R</code> as specified in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>. He then computes:<a href="#section-2.2.1.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.1.2-3.1">
                <p id="section-2.2.1.2-3.1.1"><code>TH_2 = H(kem.ct_eph, H(message_1))</code>;<a href="#section-2.2.1.2-3.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.1.2-3.2">
                <p id="section-2.2.1.2-3.2.1"><code>PRK_2e = EDHOC_Extract(TH_2, ss_eph)</code>.<a href="#section-2.2.1.2-3.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-2.2.1.2-4">And also, as in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>:<a href="#section-2.2.1.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.1.2-5.1">
                <p id="section-2.2.1.2-5.1.1"><code>KEYSTREAM_2 = EDHOC_KDF(PRK_2e, 0, TH_2, plaintext_length)</code>;<a href="#section-2.2.1.2-5.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.1.2-5.2">
                <p id="section-2.2.1.2-5.2.1"><code>SALT_3e2m = EDHOC_KDF(PRK_2e, 1, TH_2, hash_length)</code>.<a href="#section-2.2.1.2-5.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-2.2.1.2-6">Compared to <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>, the computation of <code>PRK_3e2m</code> is modified as follows :<a href="#section-2.2.1.2-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.1.2-7.1">
                <p id="section-2.2.1.2-7.1.1"><code>PRK_3e2m = EDHOC_Extract(SALT_3e2m, ss_R)</code>.<a href="#section-2.2.1.2-7.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-2.2.1.2-8">The Responder now computes <code>MAC_2</code> and assembles <code>PLAINTEXT_2</code>:<a href="#section-2.2.1.2-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.1.2-9.1">
                <p id="section-2.2.1.2-9.1.1"><code>MAC_2 = EDHOC_KDF(PRK_3e2m, 2, C_R, ID_CRED_R, TH_2, EAD_2, mac_length_2)</code>;<a href="#section-2.2.1.2-9.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.1.2-9.2">
                <p id="section-2.2.1.2-9.2.1"><code>PLAINTEXT_2 = (C_R, ID_CRED_R, MAC_2, EAD_2)</code>.<a href="#section-2.2.1.2-9.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-2.2.1.2-10">So the second message consists of:<a href="#section-2.2.1.2-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.1.2-11.1">
                <p id="section-2.2.1.2-11.1.1"><code>kem.ct_eph</code> --&gt; the ephemeral ciphertext obtained with <code>kem.pk_eph</code>;<a href="#section-2.2.1.2-11.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.1.2-11.2">
                <p id="section-2.2.1.2-11.2.1"><code>CIPHERTEXT_2 = PLAINTEXT_2 XOR KEYSTREAM_2</code>.<a href="#section-2.2.1.2-11.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
<div id="processing-message2-formatting-and-sending-message3">
<section id="section-2.2.1.3">
            <h5 id="name-processing-message_2-format">
<a href="#section-2.2.1.3" class="section-number selfRef">2.2.1.3. </a><a href="#name-processing-message_2-format" class="section-name selfRef">Processing <code>message_2</code>, formatting and sending <code>message_3</code></a>
            </h5>
<p id="section-2.2.1.3-1">On reception of the second message, the Initiator, using <code>kemp.ct_eph</code>, can compute the ephemeral shared-secret <code>ss_eph</code>. As the Responder did, he computes <code>TH_2</code>, <code>PRK_2e</code> and <code>KEYSTREAM_2</code>. He can now decipher and retrieve : <code>PLAINTEXT_2 = CIPHERTEXT_2 XOR KEYSTREAM_2</code>.<a href="#section-2.2.1.3-1" class="pilcrow">¶</a></p>
<p id="section-2.2.1.3-2">Thanks to <code>ID_CRED_R</code>, the Initiator verifies the validity of the long-term KEM public key of the Responder, <code>kemp.pk_R</code>, and computes <code>SALT_3e2m</code> and <code>PRK_3e2m</code>, using the shared-secret <code>ss_R</code> he generates at the beginning of the exchange.<a href="#section-2.2.1.3-2" class="pilcrow">¶</a></p>
<p id="section-2.2.1.3-3">At this point the Initiator is able to authenticate the Responder (at least, make sure he is talking to the endpoint he hopes to talk to). For that, he computes, as the Responder did, the MAC <code>MAC_2</code>. If it matches with the one he received, then he properly authenticated the Responder. Otherwise he aborts.<a href="#section-2.2.1.3-3" class="pilcrow">¶</a></p>
<p id="section-2.2.1.3-4">It is now up to the Initiator to authenticate himself. To do so, the Initiator computes the following elements:<a href="#section-2.2.1.3-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.1.3-5.1">
                <p id="section-2.2.1.3-5.1.1"><code>TH_3 = H(TH_2, PLAINTEXT_2, ID_CRED_R)</code>;<a href="#section-2.2.1.3-5.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.1.3-5.2">
                <p id="section-2.2.1.3-5.2.1"><code>K_3 = EDHOC_KDF(PRK_3e2m, 3, TH_3, key_length)</code>;<a href="#section-2.2.1.3-5.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.1.3-5.3">
                <p id="section-2.2.1.3-5.3.1"><code>IV_3 = EDHOC_KDF(PRK_3e2m, 4, TH_3, iv_length)</code>;<a href="#section-2.2.1.3-5.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.1.3-5.4">
                <p id="section-2.2.1.3-5.4.1"><code>MAC_3 = EDHOC_KDF(PRK_3e2m, 6, ID_CRED_I, TH_3, EAD_3, mac_length_3)</code>.<a href="#section-2.2.1.3-5.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-2.2.1.3-6">In this version of the protocol, the Initiator authenticates itself to the Responder with a signature:<a href="#section-2.2.1.3-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.1.3-7.1">
                <p id="section-2.2.1.3-7.1.1"><code>SIGNATURE_3 = DS.Sign(sign.sk_I, (ID_CRED_I, TH_3, EAD_3, MAC_3, sign_length))</code><a href="#section-2.2.1.3-7.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-2.2.1.3-8">where <code>sign.sk_I</code> is the long-term signing private key of the Initiator.<a href="#section-2.2.1.3-8" class="pilcrow">¶</a></p>
<p id="section-2.2.1.3-9">Setting <code>PLAINTEXT_3 = (ID_CRED_I, SIGNATURE_3, EAD_3)</code>, the Initiator ciphers <code>PLAINTEXT_3</code> with the AEAD encryption algorithm negociated in <code>SUITES_I</code>.<a href="#section-2.2.1.3-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="processing-message3">
<section id="section-2.2.1.4">
            <h5 id="name-processing-message_3">
<a href="#section-2.2.1.4" class="section-number selfRef">2.2.1.4. </a><a href="#name-processing-message_3" class="section-name selfRef">Processing <code>message_3</code></a>
            </h5>
<p id="section-2.2.1.4-1">On reception of <code>message_3</code>, the Responder computes <code>TH_3</code>, <code>K_3</code>, and <code>IV_3</code> as the Initiator did, and deciphers <code>CIPHERTEXT_3</code> with the AEAD decryption algorithm. With <code>PLAINTEXT_3</code>, he can compute <code>MAC_3</code> on his side, and verify the signature:<a href="#section-2.2.1.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.1.4-2.1">
                <p id="section-2.2.1.4-2.1.1"><code>DS.Verify(sign.pk_I, (ID_CRED_I, TH_3, EAD_3, MAC_3, sign_length), SIGNATURE_3)</code><a href="#section-2.2.1.4-2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-2.2.1.4-3">where <code>sign.pk_I</code> is the long-term signing public key of the Initiator. If the verification algorithm returns 1, the Responder properly authenticated the Initiator. Otherwise he aborts.<a href="#section-2.2.1.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="optionally-formatting-sending-and-receiving-message4">
<section id="section-2.2.1.5">
            <h5 id="name-optionally-formatting-sendi">
<a href="#section-2.2.1.5" class="section-number selfRef">2.2.1.5. </a><a href="#name-optionally-formatting-sendi" class="section-name selfRef">Optionally formatting, sending and receiving <code>message_4</code></a>
            </h5>
<p id="section-2.2.1.5-1">If the Responder decides of a fourth mandatory message, he then computes the following elements:<a href="#section-2.2.1.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.1.5-2.1">
                <p id="section-2.2.1.5-2.1.1"><code>TH_4 = H(TH_3, PLAINTEXT_3, ID_CRED_I)</code>;<a href="#section-2.2.1.5-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.1.5-2.2">
                <p id="section-2.2.1.5-2.2.1"><code>K_4 = EDHOC_KDF(PRK_3e2m, 8, TH_4, key_length)</code>;<a href="#section-2.2.1.5-2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.1.5-2.3">
                <p id="section-2.2.1.5-2.3.1"><code>IV_4 = EDHOC_KDF(PRK_3e2m, 9, TH_4, iv_length)</code>.<a href="#section-2.2.1.5-2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-2.2.1.5-3">Using the AEAD encryption algorithm, he ciphers <code>PLAINTEXT_4 = EAD_4</code> and sends it to the Initiator. The latter computes <code>TH_4</code>, <code>K_4</code>, <code>IV_4</code>, and deciphers <code>CIPHERTEXT_4</code> thanks to the AEAD decryption algorithm.<a href="#section-2.2.1.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="computing-the-session-key-prkout">
<section id="section-2.2.1.6">
            <h5 id="name-computing-the-session-key-p">
<a href="#section-2.2.1.6" class="section-number selfRef">2.2.1.6. </a><a href="#name-computing-the-session-key-p" class="section-name selfRef">Computing the session key <code>PRK_out</code></a>
            </h5>
<p id="section-2.2.1.6-1">It doesn't matter if there is a fourth mandatory message, in any case, both the Initiator and the Responder, in order to compute the key <code>PRK_out</code>, have to calculate the fourth transcript hash:<a href="#section-2.2.1.6-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.1.6-2.1">
                <p id="section-2.2.1.6-2.1.1"><code>TH_4 = H(TH_3, PLAINTEXT_3, ID_CRED_I)</code>.<a href="#section-2.2.1.6-2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-2.2.1.6-3">With that element, using the EDHOC_KDF algorithm, they both obtain:<a href="#section-2.2.1.6-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.1.6-4.1">
                <p id="section-2.2.1.6-4.1.1"><code>PRK_out = EDHOC_KDF(PRK_3e2m, 7, TH_4, hash_length)</code><a href="#section-2.2.1.6-4.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-2.2.1.6-5">which is the desired session key, and the authentication process is fully achieved.<a href="#section-2.2.1.6-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="key-derivation-schedule">
<section id="section-2.2.2">
          <h4 id="name-key-derivation-schedule">
<a href="#section-2.2.2" class="section-number selfRef">2.2.2. </a><a href="#name-key-derivation-schedule" class="section-name selfRef">Key Derivation Schedule</a>
          </h4>
<p id="section-2.2.2-1">In this section we summarize the key derivation operations that appears throughout the protocol.<a href="#section-2.2.2-1" class="pilcrow">¶</a></p>
<div class="breakable lang-~ sourcecode" id="section-2.2.2-2">
<pre>
          +--------------------------------+
          |TH_2=H(kem.ct_eph, H(message_1))|
          +-------+------------------------+              PLAINTEXT_2
                 |                                               |
  +------+   +---+---+   +------+   +------+   +-----------+   +-+-+
  |ss_eph|--&gt;|Extract|--&gt;|PRK_2e|--&gt;|Expand|--&gt;|KEYSTREAM_2|--&gt;|XOR|
  +------+   +-------+   +---+--+   +---+--+   +-----------+   +-+-+
                             |          |                        |
                             |          |                        v
                             |        +-+--+           +---------+--+
                             |        |TH_2|           |CIPHERTEXT_2|
                             |        +--+-+           +------------+
                         +---+--+        |
                         |Expand|--------+
                         +---+--+
                            |
                            |
                      +-----+---+
               +------|SALT_3e2m|
               |      +---------+
               |
  +----+   +---+---+   +--------+   +------+   +-----+
  |ss_R|--&gt;|Extract|--&gt;|PRK_3e2m|--&gt;|Expand|--&gt;|MAC_2|
  +----+   +-------+   +---+----+   +------+   +-----+
                           |                              PLAINTEXT_3
                           |                                   |
                           |        +------+   +--------+   +--+-+
                           +--------|Expand|--&gt;|K_3/IV_3|--&gt;|AEAD|
                           |        +---+--+   +--------+   +--+-+
                           |            |                      |
                           |            |                      v
                           |            |              +-------+----+
                           |            |              |CIPHERTEXT_3|
                           |            |              +------------+
                           |            |
                           |   +--------+---------------------------+
                           |   |TH_3=H(TH_2, PLAINTEXT_2, ID_CRED_R)|
                           |   +------------------------------------+
                           |
                           |       +------+   +-----+   +-----------+
                           +-------|Expand|--&gt;|MAC_3|--&gt;|SIGNATURE_3|
                           |       +------+   +-----+   +-----------+
                           |
                           |                              PLAINTEXT_4
                           |                                   |
                           |        +------+   +--------+   +--+-+
               message_4?  +--------|Expand|--&gt;|K_4/IV_4|--&gt;|AEAD|
                           |        +---+--+   +--------+   +--+-+
                           |            |                      |
                           |            |                      v
                           |            |              +-------+----+
                           |            |              |CIPHERTEXT_4|
                           |            |              +------------+
                           |            |
                           |   +--------+---------------------------+
                           |   |TH_4=H(TH_3, PLAINTEXT_3, ID_CRED_I)|
                           |   +--------+---------------------------+
                           |            |
                           |            |
                           |        +---+--+   +-------+
                           +--------|Expand|--&gt;|PRK_out|
                                    +------+   +-------+
</pre><a href="#section-2.2.2-2" class="pilcrow">¶</a>
</div>
<p id="section-2.2.2-3">Figure 2: PQ-EDHOC-IKR (I sign, R kem) key derivation schedule.<a href="#section-2.2.2-3" class="pilcrow">¶</a></p>
<p id="section-2.2.2-4">So we can summarize the different computations as in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>:<a href="#section-2.2.2-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.2-5">
<pre>
  PRK_2e      = EDHOC_Extract(TH_2, ss_eph);
  KEYSTREAM_2 = EDHOC_KDF(PRK_2e, 0, TH_2, plaintext_length);
  SALT_3e2m   = EDHOC_KDF(PRK_2e, 1, TH_2, hash_length);
  PRK_3e2m    = EDHOC_Extract(SALT_3e2m, ss_R);
  MAC_2       = EDHOC_KDF(PRK_3e2m, 2, context_2, mac_length_2)
                (with context_2 = C_R, ID_CRED_R, TH_2, EAD_2);
  K_3         = EDHOC_KDF(PRK_3e2m, 3, TH_3, key_length);
  IV_3        = EDHOC_KDF(PRK_3e2m, 4, TH_3, iv_length);
  MAC_3       = EDHOC_KDF(PRK_3e2m, 6, context_3, mac_length_3)
                     (with context_3 = ID_CRED_I, TH_3, EAD_3);
  K_4         = EDHOC_KDF(PRK_3e2m, 8, TH_4, key_length);
  IV_4        = EDHOC_KDF(PRK_3e2m, 9, TH_4, iv_length);
  PRK_out     = EDHOC_KDF(PRK_3e2m, 7, TH_4, hash_length).
</pre><a href="#section-2.2.2-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="additional-explanations">
<section id="section-2.2.3">
          <h4 id="name-additional-explanations">
<a href="#section-2.2.3" class="section-number selfRef">2.2.3. </a><a href="#name-additional-explanations" class="section-name selfRef">Additional explanations</a>
          </h4>
<p id="section-2.2.3-1">We detail here the main elements that differ from the original EDHOC protocol.<a href="#section-2.2.3-1" class="pilcrow">¶</a></p>
<div id="ephemeral-kem">
<section id="section-2.2.3.1">
            <h5 id="name-ephemeral-kem">
<a href="#section-2.2.3.1" class="section-number selfRef">2.2.3.1. </a><a href="#name-ephemeral-kem" class="section-name selfRef">Ephemeral KEM</a>
            </h5>
<p id="section-2.2.3.1-1">As explained in <span>[<a href="#I-D.pocero-authkem-ikr-edhoc" class="cite xref">I-D.pocero-authkem-ikr-edhoc</a>]</span>, the usual ephemeral Diffie-Hellman elements <code>(x,g^x)</code> and <code>(y,g^y)</code>, are here replaced by an ephemeral KEM:<a href="#section-2.2.3.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.3.1-2.1">
                <p id="section-2.2.3.1-2.1.1">At first, the Initiator generates a ephemeral KEM key pair <code>(kem.sk_eph, kem.pk_eph)</code> using the <code>KEM.KeyGen(k)</code> algorithm (where <code>k</code> is a security parameter);<a href="#section-2.2.3.1-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.3.1-2.2">
                <p id="section-2.2.3.1-2.2.1">On reception of the ephemeral KEM public key <code>kemp.pk_eph</code>, the Responder generates a pair <code>(ss_eph, kem.ct_eph)</code> with the <code>KEM.Encapsulation</code> algorithm (with input <code>kem.pk_eph</code>). The element <code>ss_eph</code> is the ephemeral shared-secret, later used to derive a key, and <code>kem.ct_eph</code> is the ephemeral KEM ciphertext, used by the Initiator to retrieve the ephemeral shared-secret;<a href="#section-2.2.3.1-2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.3.1-2.3">
                <p id="section-2.2.3.1-2.3.1">On reception of the ephemeral KEM ciphertext, the Initiator recovers the ephemeral shared-secret <code>ss_eph</code> thanks to the <code>KEM.Decapsulation' algorithm (with input </code>kem.sk_eph<code> and </code>kem.ct_eph`).<a href="#section-2.2.3.1-2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
<div id="authentication-keys">
<section id="section-2.2.3.2">
            <h5 id="name-authentication-keys">
<a href="#section-2.2.3.2" class="section-number selfRef">2.2.3.2. </a><a href="#name-authentication-keys" class="section-name selfRef">Authentication keys</a>
            </h5>
<p id="section-2.2.3.2-1">For the Initiator, the authentication key <span class="bcp14">MUST</span> be a static signing key pair <code>(sign.sk_I, sign.pk_I)</code> generated using a <code>DS.KeyGen(k)</code> algorithm (where <code>k</code> is a security parameter).<a href="#section-2.2.3.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2.3.2-2">For the Responder, the authentication key <span class="bcp14">MUST</span> be a static KEM key pair <code>(kem.sk_R, kem.pk_R)</code> generated using a <code>KEM.KeyGen(k)</code> algorithm (where <code>k</code> is a security parameter).<a href="#section-2.2.3.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="key-derivation">
<section id="section-2.2.3.3">
            <h5 id="name-key-derivation">
<a href="#section-2.2.3.3" class="section-number selfRef">2.2.3.3. </a><a href="#name-key-derivation" class="section-name selfRef">Key derivation</a>
            </h5>
<p id="section-2.2.3.3-1">In this version of the protocol, the EDHOC_Extract fonction is used to derive two keys, in a way that slightly differ from the original EDHOC protocol.<a href="#section-2.2.3.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.3.3-2.1">
                <p id="section-2.2.3.3-2.1.1"><code>PRK_2e = EDHOC_Extract(TH_2, ss_eph)</code> --&gt; the salt <span class="bcp14">SHALL</span> be <code>TH_2</code> and the IKM <span class="bcp14">SHALL</span> be the ephemeral shared-secret <code>ss_eph</code>;<a href="#section-2.2.3.3-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.3.3-2.2">
                <p id="section-2.2.3.3-2.2.1"><code>PRK_3e2m = EDHOC_Extract(SALT_3e2m, ss_R)</code> --&gt; the salt <span class="bcp14">SHALL</span> be <code>SALT_3e2m</code> directly derived from <code>PRK_2e</code>, and the IKM <span class="bcp14">SHALL</span> be the 'static' shared-secret <code>ss_R</code>.<a href="#section-2.2.3.3-2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-2.2.3.3-3">Concerning <code>PRK_out</code>, there is no modifications compared to the original EDHOC protocol.<a href="#section-2.2.3.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="analysis">
<section id="section-2.3">
        <h3 id="name-analysis">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-analysis" class="section-name selfRef">Analysis</a>
        </h3>
<p id="section-2.3-1">In summary, we retain here the use case proposed by <span>[<a href="#I-D.pocero-authkem-ikr-edhoc" class="cite xref">I-D.pocero-authkem-ikr-edhoc</a>]</span>, where the Initiator already knows the Responder identity. Our protocol proposes a hybridization between the protocol proposed by <span>[<a href="#I-D.pocero-authkem-ikr-edhoc" class="cite xref">I-D.pocero-authkem-ikr-edhoc</a>]</span> and EDHOC method 1. In other words, Diffie-Hellman elements are replaced with KEMs, and the Initiator authenticates here using a signature (instead of a KEM).
An important difference with the proposal of <span>[<a href="#I-D.pocero-authkem-ikr-edhoc" class="cite xref">I-D.pocero-authkem-ikr-edhoc</a>]</span> concerns the first message message_1, which in our version is simplified and remains closer to the standard EDHOC structure. Indeed, the Initiator authenticates via a signature at the third message. So he no longer needs to derive a key and encrypt part of the first message to securely send its identity.
The second message also finds itself simplified. Since the Initiator does not use KEM in this situation, the Responder has no need to generate a shared-secret <code>ss_I</code> and send the KEM ciphertext <code>kem.ct_I</code>. The second message is therefore closer to the usual EDHOC structure.
Finally, the third message is almost 'identical' to the third message of the EDHOC method 1 protocol.
It seems important to note that complete and secure authentication is ensured here entirely in three messages, and the fourth message is optional.
Regarding the Key Derivation Schedule, the changes are minor compared to <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span> (adaptation of notations, especially for the IKM to take into account the post-quantum nature of the cryptographic material) and <span>[<a href="#I-D.pocero-authkem-ikr-edhoc" class="cite xref">I-D.pocero-authkem-ikr-edhoc</a>]</span> (simply one less key derivation, since the Initiator uses a signature rather than a static KEM).
We will discuss security considerations further in this document. We will also soon present a byte comparison for each message.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="kem-sign-authentication-for-post-quantum-edhoc">
<section id="section-3">
      <h2 id="name-kem-sign-authentication-for">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-kem-sign-authentication-for" class="section-name selfRef">KEM &amp; Sign Authentication for Post-Quantum EDHOC</a>
      </h2>
<div id="motivation-1">
<section id="section-3.1">
        <h3 id="name-motivation-2">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-motivation-2" class="section-name selfRef">Motivation</a>
        </h3>
<p id="section-3.1-1">Our second idea is to propose a tradeoff, allowing for a reduced number of messages in the quantum-resistant EDHOC handshake, which come at a slightly higher computational overhead compared to <span>[<a href="#I-D.pocero-authkem-edhoc" class="cite xref">I-D.pocero-authkem-edhoc</a>]</span>.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">Starting from the standard EDHOC protocol, method 0 allows for mutual authentication via signature between both users. As proposed in <span>[<a href="#I-D.pocero-authkem-edhoc" class="cite xref">I-D.pocero-authkem-edhoc</a>]</span>, replacing classical signatures with post-quantum resistant signatures such as ML-DSA and ephemeral Diffie-Hellman elements with a KEM like ML-KEM seems reasonable to make EDHOC post-quantum resistant (even if this still needs to be proved).
These two changes do not affect the number of mandatory messages, since the fundamental structure of the protocol is preserved (however a post-quantum signature will likely be more computationally expensive, just like a KEM).
Things get complicated when trying to apply these modifications to the other three methods. Continuing on this track, we replace ephemeral Diffie-Hellman elements with an ephemeral KEM. This does not affect the usual structure of EDHOC. However, if we want to take it further and also replace long-term Diffie-Hellman elements with a KEM, managing asymmetric keys for the latter poses a problem when trying to preserve the authentication structure of EDHOC, namely a MAC derived from a long-term secret.
As proposed in <span>[<a href="#I-D.pocero-authkem-edhoc" class="cite xref">I-D.pocero-authkem-edhoc</a>]</span>, we go from 3 to 4 or 5 mandatory messages to achieve complete mutual authentication.
Here, we want to explore a different path. Our solution aims to strike a balance between the number of mandatory messages and the computations performed by each endpoint.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1-3">The principle is as follows. Suppose that the Initiator authenticates with a signature and the Responder uses a KEM. In this case, we will need an obligatory fourth message (for the Initiator to authenticate the Responder via the MAC, as proposed in <span>[<a href="#I-D.pocero-authkem-edhoc" class="cite xref">I-D.pocero-authkem-edhoc</a>]</span>).
To avoid this obligatory fourth message and return to three, we propose removing the MAC <code>MAC_2</code> used to authenticate the Responder (eliminating calculations on both sides) and replacing it with a signature from the Responder (adding calculations on both sides). To do this, the Responder signs an element (which should not be chosen randomly for security reasons and which must allow the Initiator to identify the session) and sends it directly in the second message.
The Initiator can then immediately identify the Responder: it retrieves its identity from the encrypted message and verifies the signature. The rest of the protocol remains 'unchanged', and the calculation of <code>PRK_out</code> is possible directly after sending/receiving the third message (thus no more obligatory fourth message). The costs of calculations are compensated, but the delicate point remains the size of the second message (we will provide a bytes analysis for this message later).
We decline this procedure when the Initiator wants to authenticate with a KEM and the Responder with a signature, or when both parties want to authenticate with KEMs. In these two latter cases, the number of mandatory messages compared to <span>[<a href="#I-D.pocero-authkem-edhoc" class="cite xref">I-D.pocero-authkem-edhoc</a>]</span> decreases from 5 to 4.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="first-case-initiator-signs-responder-kem-and-signs">
<section id="section-3.2">
        <h3 id="name-first-case-initiator-signs-">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-first-case-initiator-signs-" class="section-name selfRef">First case: Initiator signs, Responder KEM and signs</a>
        </h3>
<p id="section-3.2-1">We describe below the equivalent of EDHOC method 1. The Initiator will authenticate with a signature, and the Responder with a KEM and a signature.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<div id="protocol-overview">
<section id="section-3.2.1">
          <h4 id="name-protocol-overview">
<a href="#section-3.2.1" class="section-number selfRef">3.2.1. </a><a href="#name-protocol-overview" class="section-name selfRef">Protocol overview</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-3.2.1-1">
<pre>
  I                                                             R
 ---                                                           ---
  |          METHOD, SUITES_I, kem.pk_eph, C_I, EAD_1           |
  +-------------------------------------------------------------&gt;
  |                          message_1                          |
  |                                                             |
  | kem.ct_eph, Enc(KEYSTREAM_2, ID_CRED_R, EAD_2), SIGNATURE_2 |
  &lt;-------------------------------------------------------------+
  |                          message_2                          |
  |                                                             |
  |        kem.ct_R, AEAD(ID_CRED_I, Signature_3, EAD_3)        |
  +-------------------------------------------------------------&gt;
  |                          message_3                          |
  |                                                             |
  |                         AEAD(EAD_4)                         |
  &lt;- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -+
  |                          message_4                          |
</pre><a href="#section-3.2.1-1" class="pilcrow">¶</a>
</div>
<p id="section-3.2.1-2">Figure 3: PQ-EDHOC, I Signs - R KEM &amp; Signs message flow.<a href="#section-3.2.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="protocol-description">
<section id="section-3.2.2">
          <h4 id="name-protocol-description">
<a href="#section-3.2.2" class="section-number selfRef">3.2.2. </a><a href="#name-protocol-description" class="section-name selfRef">Protocol description</a>
          </h4>
<div id="formatting-and-sending-message1-1">
<section id="section-3.2.2.1">
            <h5 id="name-formatting-and-sending-messa">
<a href="#section-3.2.2.1" class="section-number selfRef">3.2.2.1. </a><a href="#name-formatting-and-sending-messa" class="section-name selfRef">Formatting and sending <code>message_1</code></a>
            </h5>
<p id="section-3.2.2.1-1">As in the usual EDHOC protocol, the first message (<code>message_1</code>) consists of:<a href="#section-3.2.2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.2.1-2.1">
                <p id="section-3.2.2.1-2.1.1"><code>METHOD</code> --&gt; as specified in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span> it is an integer specifying the authentication method the Initiator wants to use;<a href="#section-3.2.2.1-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2.2.1-2.2">
                <p id="section-3.2.2.1-2.2.1"><code>SUITES_I</code> --&gt; it consists of an ordered set of algorithms supported by the Initiator and formatted as specified in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>;<a href="#section-3.2.2.1-2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2.2.1-2.3">
                <p id="section-3.2.2.1-2.3.1"><code>C_I</code> (and also as <code>C_R</code>, which will appears later) --&gt; the Connection Identifiers chosen by the Initiator (C_I) and by the Responder (<code>C_R</code>) as specified in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>;<a href="#section-3.2.2.1-2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2.2.1-2.4">
                <p id="section-3.2.2.1-2.4.1"><code>EAD_1</code> (and also <code>EAD_2</code>, <code>EAD_3</code> and <code>EAD_4</code>, which will appear later) -&gt; External Authorization Data, respectively included in <code>message_1</code>, <code>message_2</code>, <code>message_3</code> (and optionally) <code>message_4</code>, and formatted as specified in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>;<a href="#section-3.2.2.1-2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2.2.1-2.5">
                <p id="section-3.2.2.1-2.5.1"><code>kem.pk_eph</code> --&gt; the Ephemeral KEM public key generated by the Initiator.<a href="#section-3.2.2.1-2.5.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
<div id="processing-message1-formatting-and-sending-message2-1">
<section id="section-3.2.2.2">
            <h5 id="name-processing-message_1-formatt">
<a href="#section-3.2.2.2" class="section-number selfRef">3.2.2.2. </a><a href="#name-processing-message_1-formatt" class="section-name selfRef">Processing <code>message_1</code>, formatting and sending <code>message_2</code></a>
            </h5>
<p id="section-3.2.2.2-1">On the reception of the first message, the Responder proceeds as in the original EDHOC protocol with elements <code>METHOD</code>, <code>SUITES_I</code>, <code>C_I</code> and <code>EAD_1</code>.
In a second step, using <code>kem.pk_eph</code> and the <code>KEM.Encapsulation</code> algorithm, he computes the ephemeral ciphertext <code>kem.ct_eph</code> and the ephemeral shared-secret <code>ss_eph</code>.<a href="#section-3.2.2.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2.2.2-2">The Responder selects its Connection Identifier <code>C_R</code> as specified in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>. He then computes:<a href="#section-3.2.2.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.2.2-3.1">
                <p id="section-3.2.2.2-3.1.1"><code>TH_2 = H(kem.ct_eph, H(message_1))</code>;<a href="#section-3.2.2.2-3.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2.2.2-3.2">
                <p id="section-3.2.2.2-3.2.1"><code>PRK_2e = EDHOC_Extract(TH_2, ss_eph)</code>;<a href="#section-3.2.2.2-3.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2.2.2-3.3">
                <p id="section-3.2.2.2-3.3.1"><code>KEYSTREAM_2 = EDHOC_KDF(PRK_2e, 0, TH_2, plaintext_length)</code>.<a href="#section-3.2.2.2-3.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.2.2.2-4">The Responder now assembles <code>PLAINTEXT_2</code>:<a href="#section-3.2.2.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.2.2-5.1">
                <p id="section-3.2.2.2-5.1.1"><code>PLAINTEXT_2 = (C_R, ID_CRED_R, TH_2, EAD_2)</code><a href="#section-3.2.2.2-5.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.2.2.2-6">then ciphers this message :<a href="#section-3.2.2.2-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.2.2-7.1">
                <p id="section-3.2.2.2-7.1.1"><code>CIPHERTEXT_2 = PLAINTEXT_2 XOR KEYSTREAM_2</code><a href="#section-3.2.2.2-7.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.2.2.2-8">and finally signs this ciphertext:<a href="#section-3.2.2.2-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.2.2-9.1">
                <p id="section-3.2.2.2-9.1.1"><code>SIGNATURE_2 = DS.Sign(sign.sk_R, (CIPHERTEXT_2, sign_length))</code><a href="#section-3.2.2.2-9.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.2.2.2-10">where <code>sign.sk_R</code> is the long-term signing private key of the Responder.<a href="#section-3.2.2.2-10" class="pilcrow">¶</a></p>
<p id="section-3.2.2.2-11">So the second message then consists of:<a href="#section-3.2.2.2-11" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.2.2-12.1">
                <p id="section-3.2.2.2-12.1.1"><code>kem.ct_eph</code> --&gt; the ephemeral ciphertext obtained with <code>kem.pk_eph</code>;<a href="#section-3.2.2.2-12.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2.2.2-12.2">
                <p id="section-3.2.2.2-12.2.1"><code>CIPHERTEXT_2</code>;<a href="#section-3.2.2.2-12.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2.2.2-12.3">
                <p id="section-3.2.2.2-12.3.1"><code>SIGNATURE_2</code>.<a href="#section-3.2.2.2-12.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.2.2.2-13"><strong>Important note:</strong> let us mention that the element signed by the Responder, for security considerations during the security analysis, could be subject to slight changes. However, it serves here to illustrate the principle proposed here.<a href="#section-3.2.2.2-13" class="pilcrow">¶</a></p>
</section>
</div>
<div id="processing-message2-formatting-and-sending-message3-1">
<section id="section-3.2.2.3">
            <h5 id="name-processing-message_2-formatt">
<a href="#section-3.2.2.3" class="section-number selfRef">3.2.2.3. </a><a href="#name-processing-message_2-formatt" class="section-name selfRef">Processing <code>message_2</code>, formatting and sending <code>message_3</code></a>
            </h5>
<p id="section-3.2.2.3-1">On reception of the second message, the Initiator, using <code>kemp.ct_eph</code>, can compute the ephemeral shared-secret <code>ss_eph</code>. As the Responder did, he computes <code>TH_2</code>, <code>PRK_2e</code> and <code>KEYSTREAM_2</code>. He can now decipher and retrieve : <code>PLAINTEXT_2 = CIPHERTEXT_2 XOR KEYSTREAM_2</code>.<a href="#section-3.2.2.3-1" class="pilcrow">¶</a></p>
<p id="section-3.2.2.3-2">Thanks to <code>ID_CRED_R</code>, the Initiator obtains the long-term public keys of the Responder, <code>kemp.pk_R</code> and <code>sign.pk_R</code>.
At first, he checks the validity of the signature of the Responder:<a href="#section-3.2.2.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.2.3-3.1">
                <p id="section-3.2.2.3-3.1.1"><code>DS.Verify(sign.pk_R, (CIPHERTEXT_2, sign_length), SIGNATURE_2)</code>.<a href="#section-3.2.2.3-3.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.2.2.3-4">If the verification algorithm returns 1, the Initiator properly authenticated the Responder. Otherwise he aborts.<a href="#section-3.2.2.3-4" class="pilcrow">¶</a></p>
<p id="section-3.2.2.3-5">Assuming everything goes well, using the KEM encapsulation algorithm <code>KEM.Encapsulation</code>, and the long-term input material <code>kem.pk_R</code> of the Responder, the Initiator generated the couple <code>(ss_R, kem.ct_R)</code>.<a href="#section-3.2.2.3-5" class="pilcrow">¶</a></p>
<p id="section-3.2.2.3-6">The shared-secret <code>ss_R</code> will then serve as IKM for the computation of <code>PRK_3e2m</code>:<a href="#section-3.2.2.3-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.2.3-7.1">
                <p id="section-3.2.2.3-7.1.1"><code>SALT_3e2m = EDHOC_KDF(PRK_2e, 1, TH_2, hash_length)</code>;<a href="#section-3.2.2.3-7.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2.2.3-7.2">
                <p id="section-3.2.2.3-7.2.1"><code>PRK_3e2m = EDHOC_Extract(SALT_3e2m, ss_R)</code>.<a href="#section-3.2.2.3-7.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.2.2.3-8">It is now the turn of the Initiator to authenticate himself. To do so, he computes the following elements:<a href="#section-3.2.2.3-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.2.3-9.1">
                <p id="section-3.2.2.3-9.1.1"><code>TH_3 = H(TH_2, PLAINTEXT_2, ID_CRED_R)</code>;<a href="#section-3.2.2.3-9.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2.2.3-9.2">
                <p id="section-3.2.2.3-9.2.1"><code>K_3 = EDHOC_KDF(PRK_3e2m, 3, TH_3, key_length)</code>;<a href="#section-3.2.2.3-9.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2.2.3-9.3">
                <p id="section-3.2.2.3-9.3.1"><code>IV_3 = EDHOC_KDF(PRK_3e2m, 4, TH_3, iv_length)</code>;<a href="#section-3.2.2.3-9.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2.2.3-9.4">
                <p id="section-3.2.2.3-9.4.1"><code>MAC_3 = EDHOC_KDF(PRK_3e2m, 6, ID_CRED_I, TH_3, EAD_3, mac_length_3)</code><a href="#section-3.2.2.3-9.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.2.2.3-10">as in the original EDHOC protocol. Then comes the signature:<a href="#section-3.2.2.3-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.2.3-11.1">
                <p id="section-3.2.2.3-11.1.1"><code>SIGNATURE_3 = DS.Sign(sign.sk_I, (ID_CRED_I, TH_3, EAD_3, MAC_3, sign_length))</code><a href="#section-3.2.2.3-11.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.2.2.3-12">where <code>sign.sk_I</code> is the long-term signing private key of the Initiator.<a href="#section-3.2.2.3-12" class="pilcrow">¶</a></p>
<p id="section-3.2.2.3-13">Setting <code>PLAINTEXT_3 = (ID_CRED_I, SIGNATURE_3, EAD_3)</code>, the Initiator ciphers <code>PLAINTEXT_3</code> with the AEAD encryption algorithm negociated in <code>SUITES_I</code>.
The third message is then composed of:<a href="#section-3.2.2.3-13" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.2.3-14.1">
                <p id="section-3.2.2.3-14.1.1"><code>CIPHERTEXT_3</code>;<a href="#section-3.2.2.3-14.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2.2.3-14.2">
                <p id="section-3.2.2.3-14.2.1"><code>kem.ct_R</code>.<a href="#section-3.2.2.3-14.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
<div id="processing-message3-1">
<section id="section-3.2.2.4">
            <h5 id="name-processing-message_3-2">
<a href="#section-3.2.2.4" class="section-number selfRef">3.2.2.4. </a><a href="#name-processing-message_3-2" class="section-name selfRef">Processing <code>message_3</code></a>
            </h5>
<p id="section-3.2.2.4-1">On reception of <code>message_3</code>, the Responder computes <code>TH_3</code>. He also used the <code>KEM.Decapsulation</code> algorithm with its long-term KEM private key <code>kem.sk_R</code> and the KEM ciphertext <code>kem.ct_R</code>, to obtain the shared-secret <code>ss_R</code>.<a href="#section-3.2.2.4-1" class="pilcrow">¶</a></p>
<p id="section-3.2.2.4-2">He can now compute <code>SALT_3e2m</code>, <code>PRK_3e2m</code>, <code>K_3</code>, and <code>IV_3</code> as the Initiator did, and deciphers <code>CIPHERTEXT_3</code> with the AEAD decryption algorithm.
With <code>PLAINTEXT_3</code>, he calculates <code>MAC_3</code> on his side, and verifies the signature:<a href="#section-3.2.2.4-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.2.4-3.1">
                <p id="section-3.2.2.4-3.1.1"><code>DS.Verify(sign.pk_I, (ID_CRED_I, TH_3, EAD_3, MAC_3, sign_length), SIGNATURE_3)</code><a href="#section-3.2.2.4-3.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.2.2.4-4">where <code>sign.pk_I</code> is the long-term signing public key of the Initiator. If the verification algorithm returns 1, the Initiator is properly authenticated to the Initiator. Otherwise the Responder aborts.<a href="#section-3.2.2.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="optionally-formatting-sending-and-receiving-message4-1">
<section id="section-3.2.2.5">
            <h5 id="name-optionally-formatting-sendin">
<a href="#section-3.2.2.5" class="section-number selfRef">3.2.2.5. </a><a href="#name-optionally-formatting-sendin" class="section-name selfRef">Optionally formatting, sending and receiving <code>message_4</code></a>
            </h5>
<p id="section-3.2.2.5-1">If the Responder decides of a fourth mandatory message, he then computes the following elements:<a href="#section-3.2.2.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.2.5-2.1">
                <p id="section-3.2.2.5-2.1.1"><code>TH_4 = H(TH_3, PLAINTEXT_3, ID_CRED_I)</code>;<a href="#section-3.2.2.5-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2.2.5-2.2">
                <p id="section-3.2.2.5-2.2.1"><code>K_4 = EDHOC_KDF(PRK_3e2m, 8, TH_4, key_length)</code>;<a href="#section-3.2.2.5-2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2.2.5-2.3">
                <p id="section-3.2.2.5-2.3.1"><code>IV_4 = EDHOC_KDF(PRK_3e2m, 9, TH_4, iv_length)</code>.<a href="#section-3.2.2.5-2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.2.2.5-3">Using the AEAD encryption algorithm, he ciphers <code>PLAINTEXT_4 = EAD_4</code> and sends it to the Initiator. The latter computes <code>TH_4</code>, <code>K_4</code>, <code>IV_4</code>, and deciphers <code>CIPHERTEXT_4</code> thanks to the AEAD decryption algorithm.<a href="#section-3.2.2.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="computing-the-session-key-prkout-1">
<section id="section-3.2.2.6">
            <h5 id="name-computing-the-session-key-pr">
<a href="#section-3.2.2.6" class="section-number selfRef">3.2.2.6. </a><a href="#name-computing-the-session-key-pr" class="section-name selfRef">Computing the session key <code>PRK_out</code></a>
            </h5>
<p id="section-3.2.2.6-1">Here again, it doesn't matter if there is a fourth mandatory message, in any case, both the Initiator and the Responder, in order to compute the key <code>PRK_out</code>, have to calculate the fourth transcript hash as in the original EDHOC protocol:<a href="#section-3.2.2.6-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.2.6-2.1">
                <p id="section-3.2.2.6-2.1.1"><code>TH_4 = H(TH_3, PLAINTEXT_3, ID_CRED_I)</code>.<a href="#section-3.2.2.6-2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.2.2.6-3">With this element, using the EDHOC_KDF, they both obtain:<a href="#section-3.2.2.6-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.2.6-4.1">
                <p id="section-3.2.2.6-4.1.1"><code>PRK_out = EDHOC_KDF(PRK_3e2m, 7, TH_4, hash_length)</code><a href="#section-3.2.2.6-4.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.2.2.6-5">which is the desired session key, and the authentication process is fully achieved.<a href="#section-3.2.2.6-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="associated-key-derivation-schedule">
<section id="section-3.2.3">
          <h4 id="name-associated-key-derivation-s">
<a href="#section-3.2.3" class="section-number selfRef">3.2.3. </a><a href="#name-associated-key-derivation-s" class="section-name selfRef">Associated key derivation schedule</a>
          </h4>
<p id="section-3.2.3-1">In this section we present the key derivation schedule of the previously described protocol version.<a href="#section-3.2.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.3-2">
<pre>
          +--------------------------------+
          |TH_2=H(kem.ct_eph, H(message_1))|
          +------+----------------------+--+              PLAINTEXT_2
                 |                      |                        |
  +------+   +---+---+   +------+   +---+--+   +-----------+   +-+-+
  |ss_eph|--&gt;|Extract|--&gt;|PRK_2e|--&gt;|Expand|--&gt;|KEYSTREAM_2|--&gt;|XOR|
  +------+   +-------+   +---+--+   +---+--+   +-----------+   +-+-+
                             |                                   |
                             |                                   v
                             |                         +---------+--+
                             |                         |CIPHERTEXT_2|
                             |                         +---------+--+
                             |                                   |
                             |                                   v
                             |                          +-----------+
                             |                          |SIGNATURE_2|
                             |                          +-----------+
                             |
           +---------+   +---+--+
           |SALT_3e2m|&lt;--|Expand|
           +---+-----+   +---+--+                         PLAINTEXT_3
               |                                               |
  +----+   +---+---+   +--------+   +------+   +--------+   +--+-+
  |ss_R|--&gt;|Extract|--&gt;|PRK_3e2m|--&gt;|Expand|--&gt;|K_3/IV_3|--&gt;|AEAD|
  +----+   +-------+   +---+----+   +---+--+   +--------+   +--+-+
                           |            |                      |
                           |            |                      v
                           |            |              +-------+----+
                           |            |              |CIPHERTEXT_3|
                           |            |              +------------+
                           |            |
                           |   +--------+---------------------------+
                           |   |TH_3=H(TH_2, PLAINTEXT_2, ID_CRED_R)|
                           |   +------------------------------------+
                           |
                           |       +------+   +-----+   +-----------+
                           +-------|Expand|--&gt;|MAC_3|--&gt;|SIGNATURE_3|
                           |       +------+   +-----+   +-----------+
                           |
                           |                              PLAINTEXT_4
                           |                                   |
                           |        +------+   +--------+   +--+-+
               message_4?  +--------|Expand|--&gt;|K_4/IV_4|--&gt;|AEAD|
                           |        +---+--+   +--------+   +--+-+
                           |            |                      |
                           |            |                      v
                           |            |              +-------+----+
                           |            |              |CIPHERTEXT_4|
                           |            |              +------------+
                           |            |
                           |   +--------+---------------------------+
                           |   |TH_4=H(TH_3, PLAINTEXT_3, ID_CRED_I)|
                           |   +--------+---------------------------+
                           |            |
                           |            |
                           |        +---+--+   +-------+
                           +--------|Expand|--&gt;|PRK_out|
                                    +------+   +-------+
</pre><a href="#section-3.2.3-2" class="pilcrow">¶</a>
</div>
<p id="section-3.2.3-3">Figure 4: PQ-EDHOC, I Signs - R KEM &amp; Signs key derivation schedule.<a href="#section-3.2.3-3" class="pilcrow">¶</a></p>
<p id="section-3.2.3-4">So we can summarize the different computations as previously:<a href="#section-3.2.3-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.3-5">
<pre>
  PRK_2e      = EDHOC_Extract(TH_2, ss_eph);
  KEYSTREAM_2 = EDHOC_KDF(PRK_2e, 0, TH_2, plaintext_length);
  SALT_3e2m   = EDHOC_KDF(PRK_2e, 1, TH_2, hash_length);
  PRK_3e2m    = EDHOC_Extract(SALT_3e2m, ss_R);
  K_3         = EDHOC_KDF(PRK_3e2m, 3, TH_3, key_length);
  IV_3        = EDHOC_KDF(PRK_3e2m, 4, TH_3, iv_length);
  MAC_3       = EDHOC_KDF(PRK_3e2m, 6, context_3, mac_length_3)
                     (with context_3 = ID_CRED_I, TH_3, EAD_3);
  K_4         = EDHOC_KDF(PRK_3e2m, 8, TH_4, key_length);
  IV_4        = EDHOC_KDF(PRK_3e2m, 9, TH_4, iv_length);
  PRK_out     = EDHOC_KDF(PRK_3e2m, 7, TH_4, hash_length).
</pre><a href="#section-3.2.3-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="additional-explanations-1">
<section id="section-3.2.4">
          <h4 id="name-additional-explanations-2">
<a href="#section-3.2.4" class="section-number selfRef">3.2.4. </a><a href="#name-additional-explanations-2" class="section-name selfRef">Additional explanations</a>
          </h4>
<p id="section-3.2.4-1">We detail here the main elements that differ from the original EDHOC protocol.<a href="#section-3.2.4-1" class="pilcrow">¶</a></p>
<div id="ephemeral-kem-1">
<section id="section-3.2.4.1">
            <h5 id="name-ephemeral-kem-2">
<a href="#section-3.2.4.1" class="section-number selfRef">3.2.4.1. </a><a href="#name-ephemeral-kem-2" class="section-name selfRef">Ephemeral KEM</a>
            </h5>
<p id="section-3.2.4.1-1">As previously explain the usual ephemeral Diffie-Hellman elements are replaced by an ephemeral KEM. In this protocol, it works exactly as we previously described.<a href="#section-3.2.4.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authentication-keys-1">
<section id="section-3.2.4.2">
            <h5 id="name-authentication-keys-2">
<a href="#section-3.2.4.2" class="section-number selfRef">3.2.4.2. </a><a href="#name-authentication-keys-2" class="section-name selfRef">Authentication keys</a>
            </h5>
<p id="section-3.2.4.2-1">For the Initiator, the authentication key <span class="bcp14">MUST</span> be a static signing key pair <code>(sign.sk_I, sign.pk_I)</code> generated using a <code>DS.KeyGen(k)</code> algorithm (where <code>k</code> is a security parameter).<a href="#section-3.2.4.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2.4.2-2">For the Responder, the authentication key <span class="bcp14">MUST</span> be: (1) a static KEM key pair <code>(kem.sk_R, kem.pk_R)</code> generated using a <code>KEM.KeyGen(k)</code> algorithm (where <code>k</code> is a security parameter) <strong>and</strong> (2) a static signing key pair <code>(sign.sk_R, sign.pk_R)</code> generated using a <code>DS.KeyGen(k)</code> algorithm (where <code>k</code> is a security parameter).<a href="#section-3.2.4.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="key-derivation-1">
<section id="section-3.2.4.3">
            <h5 id="name-key-derivation-2">
<a href="#section-3.2.4.3" class="section-number selfRef">3.2.4.3. </a><a href="#name-key-derivation-2" class="section-name selfRef">Key derivation</a>
            </h5>
<p id="section-3.2.4.3-1">In this version of the protocol, the keys <code>PRK_2e</code> and <code>PRK_3e2m</code> are obtain thanks to EDHOC_Extract fonction:<a href="#section-3.2.4.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.4.3-2.1">
                <p id="section-3.2.4.3-2.1.1"><code>PRK_2e = EDHOC_Extract(TH_2, ss_eph)</code> --&gt; the salt <span class="bcp14">SHALL</span> be <code>TH_2</code> and the IKM <span class="bcp14">SHALL</span> be the ephemeral shared-secret <code>ss_eph</code>;<a href="#section-3.2.4.3-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2.4.3-2.2">
                <p id="section-3.2.4.3-2.2.1"><code>PRK_3e2m = EDHOC_Extract(SALT_3e2m, ss_R)</code> --&gt; the salt <span class="bcp14">SHALL</span> be <code>SALT_3e2m</code> directly derived from <code>PRK_2e</code>, and the IKM <span class="bcp14">SHALL</span> be the 'static' shared-secret <code>ss_R</code>.<a href="#section-3.2.4.3-2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.2.4.3-3">Concerning <code>PRK_out</code>, here again, there is no modifications compared to the original EDHOC protocol.<a href="#section-3.2.4.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="analysis-1">
<section id="section-3.2.5">
          <h4 id="name-analysis-2">
<a href="#section-3.2.5" class="section-number selfRef">3.2.5. </a><a href="#name-analysis-2" class="section-name selfRef">Analysis</a>
          </h4>
<p id="section-3.2.5-1">In this version of the protocol, we assumed that the Initiator has a pair of static signature keys <code>(sign.sk_I, sign.pk_I)</code> and that the Responder has not only a pair of static signature keys <code>(sign.sk_R, sign.pk_R)</code> but also a pair of static KEM keys <code>(kem.sk_R, kem.pk_R)</code>.
This is not an unusual case. We can suppose that each user, when registering in a Public Key Infrastructure (PKI), provides pairs of keys of both types (signature and KEM), which they update regularly. The difference in our protocol is that the Responder is forced to use both types during the same AKE.
From a technical point of view, the first message <code>message_1</code> and the third message <code>message_3</code> do not differ from those proposed in <span>[<a href="#I-D.pocero-authkem-edhoc" class="cite xref">I-D.pocero-authkem-edhoc</a>]</span>. Two major differences are worth noting regarding the messages.
Firstly, here we have only an <strong>optional</strong> fourth message <code>message_4</code>. Secondly, our second message <code>message_2</code> contains an additional signature <code>SIGNATURE_2</code> (we will propose a byte analysis of this message later).
Finally, from a computational point of view, both the Initiator and the Responder no longer need to calculate the MAC <code>MAC_2</code>. In return, the Responder must sign a message, and the Initiator must verify this signature.
Regarding the Key Derivation Schedule, aside from the IKM which adapts to post-quantum cryptographic material, we remain close to the one of EDHOC's method 1.
We thus have a tradeoff between the size of messages, calculation capabilities, and the number of messages.<a href="#section-3.2.5-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="second-case-initiator-kem-and-signs-responder-signs">
<section id="section-3.3">
        <h3 id="name-second-case-initiator-kem-a">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-second-case-initiator-kem-a" class="section-name selfRef">Second case: Initiator KEM and signs, Responder signs</a>
        </h3>
<p id="section-3.3-1">We now invert the roles and describe below the equivalent of EDHOC method 2. The Initiator will authenticate with a KEM and a signature, and the Responder only with a signature.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<div id="protocol-overview-1">
<section id="section-3.3.1">
          <h4 id="name-protocol-overview-2">
<a href="#section-3.3.1" class="section-number selfRef">3.3.1. </a><a href="#name-protocol-overview-2" class="section-name selfRef">Protocol overview</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-3.3.1-1">
<pre>
  I                                                             R
 ---                                                           ---
  |          METHOD, SUITES_I, kem.pk_eph, C_I, EAD_1           |
  +-------------------------------------------------------------&gt;
  |                          message_1                          |
  |                                                             |
  | kem.ct_eph, Enc(KEYSTREAM_2, ID_CRED_R, EAD_2, SIGNATURE_2) |
  &lt;-------------------------------------------------------------+
  |                          message_2                          |
  |                                                             |
  |             AEAD(ID_CRED_I, EAD_3), Signature_3             |
  +-------------------------------------------------------------&gt;
  |                          message_3                          |
  |                                                             |
  |                    kem.ct_I, AEAD(EAD_4)                    |
  &lt;-------------------------------------------------------------+
  |                          message_4                          |
</pre><a href="#section-3.3.1-1" class="pilcrow">¶</a>
</div>
<p id="section-3.3.1-2">Figure 5: PQ-EDHOC, I KEM &amp; Signs - R Signs message flow.<a href="#section-3.3.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="protocol-description-1">
<section id="section-3.3.2">
          <h4 id="name-protocol-description-2">
<a href="#section-3.3.2" class="section-number selfRef">3.3.2. </a><a href="#name-protocol-description-2" class="section-name selfRef">Protocol description</a>
          </h4>
<div id="formatting-and-sending-message1-2">
<section id="section-3.3.2.1">
            <h5 id="name-formatting-and-sending-messag">
<a href="#section-3.3.2.1" class="section-number selfRef">3.3.2.1. </a><a href="#name-formatting-and-sending-messag" class="section-name selfRef">Formatting and sending <code>message_1</code></a>
            </h5>
<p id="section-3.3.2.1-1">As for our previous protocol version, the first message (<code>message_1</code>) consists of:<a href="#section-3.3.2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.2.1-2.1">
                <p id="section-3.3.2.1-2.1.1"><code>METHOD</code> --&gt; as specified in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span> it is an integer specifying the authentication method the Initiator wants to use;<a href="#section-3.3.2.1-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.3.2.1-2.2">
                <p id="section-3.3.2.1-2.2.1"><code>SUITES_I</code> --&gt; it consists of an ordered set of algorithms supported by the Initiator and formatted as specified in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>;<a href="#section-3.3.2.1-2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.3.2.1-2.3">
                <p id="section-3.3.2.1-2.3.1"><code>C_I</code> (and also as <code>C_R</code>, which will appears later) --&gt; the Connection Identifiers chosen by the Initiator (C_I) and by the Responder (<code>C_R</code>) as specified in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>;<a href="#section-3.3.2.1-2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.3.2.1-2.4">
                <p id="section-3.3.2.1-2.4.1"><code>EAD_1</code> (and also <code>EAD_2</code>, <code>EAD_3</code> and <code>EAD_4</code>, which will appear later) -&gt; External Authorization Data, respectively included in <code>message_1</code>, <code>message_2</code>, <code>message_3</code> (and optionally) <code>message_4</code>, and formatted as specified in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>;<a href="#section-3.3.2.1-2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.3.2.1-2.5">
                <p id="section-3.3.2.1-2.5.1"><code>kem.pk_eph</code> --&gt; the Ephemeral KEM public key generated by the Initiator.<a href="#section-3.3.2.1-2.5.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
<div id="processing-message1-formatting-and-sending-message2-2">
<section id="section-3.3.2.2">
            <h5 id="name-processing-message_1-formatti">
<a href="#section-3.3.2.2" class="section-number selfRef">3.3.2.2. </a><a href="#name-processing-message_1-formatti" class="section-name selfRef">Processing <code>message_1</code>, formatting and sending <code>message_2</code></a>
            </h5>
<p id="section-3.3.2.2-1">On the reception of the first message, the Responder proceeds as in the original EDHOC protocol with elements <code>METHOD</code>, <code>SUITES_I</code>, <code>C_I</code> and <code>EAD_1</code>.
In a second step, using <code>kem.pk_eph</code> and the <code>KEM.Encapsulation</code> algorithm, he computes the ephemeral ciphertext <code>kem.ct_eph</code> and the ephemeral shared-secret <code>ss_eph</code>.<a href="#section-3.3.2.2-1" class="pilcrow">¶</a></p>
<p id="section-3.3.2.2-2">The Responder selects its Connection Identifier <code>C_R</code> as specified in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>. He then computes:<a href="#section-3.3.2.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.2.2-3.1">
                <p id="section-3.3.2.2-3.1.1"><code>TH_2 = H(kem.ct_eph, H(message_1))</code>;<a href="#section-3.3.2.2-3.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.3.2.2-3.2">
                <p id="section-3.3.2.2-3.2.1"><code>PRK_2e = EDHOC_Extract(TH_2, ss_eph)</code>;<a href="#section-3.3.2.2-3.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.3.2.2-3.3">
                <p id="section-3.3.2.2-3.3.1"><code>KEYSTREAM_2 = EDHOC_KDF(PRK_2e, 0, TH_2, plaintext_length)</code>.<a href="#section-3.3.2.2-3.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.3.2.2-4">In order to authenticate himself to the Initiator, in this version, similarly to the EDHOC method 2, the Responder computes a MAC <code>MAC_2</code> and signs it with its long-term signing private key <code>sign.sk_R</code>:<a href="#section-3.3.2.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.2.2-5.1">
                <p id="section-3.3.2.2-5.1.1"><code>MAC_2 = EDHOC_KDF(PRK_2e, 2, C_R, ID_CRED_R, TH_2, EAD_2, mac_length_2)</code>;<a href="#section-3.3.2.2-5.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.3.2.2-5.2">
                <p id="section-3.3.2.2-5.2.1">`SIGNATURE_2 = DS.Sign(sign.sk_R, (C_R, ID_CRED_R, TH_2, EAD_2, MAC_2, sign_length)).<a href="#section-3.3.2.2-5.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.3.2.2-6">The Responder now assembles <code>PLAINTEXT_2</code>:<a href="#section-3.3.2.2-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.2.2-7.1">
                <p id="section-3.3.2.2-7.1.1"><code>PLAINTEXT_2 = (C_R, ID_CRED_R, SIGNATURE_2, EAD_2)</code><a href="#section-3.3.2.2-7.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.3.2.2-8">then ciphers this message :<a href="#section-3.3.2.2-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.2.2-9.1">
                <p id="section-3.3.2.2-9.1.1"><code>CIPHERTEXT_2 = PLAINTEXT_2 XOR KEYSTREAM_2</code><a href="#section-3.3.2.2-9.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.3.2.2-10">and finally sends <code>message_2</code> composed of <code>CIPHERTEXT_2</code> and <code>kem.ct_eph</code>.
So, so far, except the ephemeral KEM material, everything works like in the usual EDHOC method 2 protocol.<a href="#section-3.3.2.2-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="processing-message2-formatting-and-sending-message3-2">
<section id="section-3.3.2.3">
            <h5 id="name-processing-message_2-formatti">
<a href="#section-3.3.2.3" class="section-number selfRef">3.3.2.3. </a><a href="#name-processing-message_2-formatti" class="section-name selfRef">Processing <code>message_2</code>, formatting and sending <code>message_3</code></a>
            </h5>
<p id="section-3.3.2.3-1">On reception of the second message, the Initiator, using <code>kemp.ct_eph</code>, can compute the ephemeral shared-secret <code>ss_eph</code>. As the Responder did, he computes <code>TH_2</code>, <code>PRK_2e</code> and <code>KEYSTREAM_2</code>. He can now decipher and retrieve : <code>PLAINTEXT_2 = CIPHERTEXT_2 XOR KEYSTREAM_2</code>.<a href="#section-3.3.2.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3.2.3-2">Thanks to <code>ID_CRED_R</code>, the Initiator obtains the long-term signing public key of the Responder, <code>sign.pk_R</code>.
He can then compute <code>MAC_2</code> on its own, and check the validity of the signature of the Responder:<a href="#section-3.3.2.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.2.3-3.1">
                <p id="section-3.3.2.3-3.1.1"><code>DS.Verify(sign.pk_R, (C_R, ID_CRED_R, TH_2, EAD_2, MAC_2, sign_length), SIGNATURE_2)</code>.<a href="#section-3.3.2.3-3.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.3.2.3-4">If the verification algorithm returns 1, the Initiator properly authenticated the Responder. Otherwise he aborts.<a href="#section-3.3.2.3-4" class="pilcrow">¶</a></p>
<p id="section-3.3.2.3-5">Assuming everything goes well, the Initiator computes the following elements:<a href="#section-3.3.2.3-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.2.3-6.1">
                <p id="section-3.3.2.3-6.1.1"><code>TH_3 = H(TH_2, PLAINTEXT_2, ID_CRED_R)</code>;<a href="#section-3.3.2.3-6.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.3.2.3-6.2">
                <p id="section-3.3.2.3-6.2.1"><code>K_3 = EDHOC_KDF(PRK_2e, 3, TH_3, key_length)</code>;<a href="#section-3.3.2.3-6.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.3.2.3-6.3">
                <p id="section-3.3.2.3-6.3.1"><code>IV_3 = EDHOC_KDF(PRK_2e, 4, TH_3, iv_length)</code>.<a href="#section-3.3.2.3-6.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.3.2.3-7">He then forms <code>PLAINTEXT_3 = (ID_CRED_I, TH_3, EAD_3)</code> ciphers it with the AEAD encryption algorithm negociated in <code>SUITES_I</code>.<a href="#section-3.3.2.3-7" class="pilcrow">¶</a></p>
<p id="section-3.3.2.3-8">Then, in order to authenticate, he signs the ciphertext:<a href="#section-3.3.2.3-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.2.3-9.1">
                <p id="section-3.3.2.3-9.1.1"><code>SIGNATURE_3 = DS.Sign(sign.sk_I, (CIPHERTEXT_3, sign_length))</code><a href="#section-3.3.2.3-9.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.3.2.3-10">where <code>sign.sk_I</code> is the long-term signing private key of the Initiator. The third message is then composed of:<a href="#section-3.3.2.3-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.2.3-11.1">
                <p id="section-3.3.2.3-11.1.1"><code>CIPHERTEXT_3</code>;<a href="#section-3.3.2.3-11.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.3.2.3-11.2">
                <p id="section-3.3.2.3-11.2.1"><code>SIGNATURE_3</code>.<a href="#section-3.3.2.3-11.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.3.2.3-12"><strong>Important note:</strong> let us mention that the element signed by the Initiator, here again, for security considerations during the security analysis, could be subject to slight changes.<a href="#section-3.3.2.3-12" class="pilcrow">¶</a></p>
</section>
</div>
<div id="processing-message3-formatting-and-sending-message4">
<section id="section-3.3.2.4">
            <h5 id="name-processing-message_3-format">
<a href="#section-3.3.2.4" class="section-number selfRef">3.3.2.4. </a><a href="#name-processing-message_3-format" class="section-name selfRef">Processing <code>message_3</code>, formatting and sending <code>message_4</code></a>
            </h5>
<p id="section-3.3.2.4-1">On reception of <code>message_3</code>, the Responder computes <code>TH_3</code>, <code>K_3</code> and <code>IV_3</code>, and deciphers <code>CIPHERTEXT_3</code> with the AEAD decryption algorithm.
With <code>PLAINTEXT_3</code>, he obtains the Initiator's long-term signing public key, and so he verifies the signature:<a href="#section-3.3.2.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.2.4-2.1">
                <p id="section-3.3.2.4-2.1.1"><code>DS.Verify(sign.pk_I, (CIPHERTEXT_3, sign_length), SIGNATURE_3)</code>.<a href="#section-3.3.2.4-2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.3.2.4-3">If the verification algorithm returns 1, the Initiator is properly authenticated to the Initiator. Otherwise the Responder aborts.
With <code>PLAINTEXT_3</code>, the Responder also gets the Initiator's long-term KEM public key. He then uses the <code>KEM.Encapsulation</code> algorithm to generate <code>ss_I</code> and <code>kem.ct_I</code>.<a href="#section-3.3.2.4-3" class="pilcrow">¶</a></p>
<p id="section-3.3.2.4-4">Following that, he computes:<a href="#section-3.3.2.4-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.2.4-5.1">
                <p id="section-3.3.2.4-5.1.1"><code>TH_4 = H(TH_3, PLAINTEXT_3, ID_CRED_I)</code>;<a href="#section-3.3.2.4-5.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.3.2.4-5.2">
                <p id="section-3.3.2.4-5.2.1"><code>SALT_4e3m = EDHOC_KDF(PRK_2e, 5, TH_4, hash_length)</code>;<a href="#section-3.3.2.4-5.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.3.2.4-5.3">
                <p id="section-3.3.2.4-5.3.1"><code>PRK_4e3m = EDHOC_Extract(SALT_4e3m, ss_I)</code>;<a href="#section-3.3.2.4-5.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.3.2.4-5.4">
                <p id="section-3.3.2.4-5.4.1"><code>K_4 = EDHOC_KDF(PRK_4e3m, 8, TH_4, key_length)</code>;<a href="#section-3.3.2.4-5.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.3.2.4-5.5">
                <p id="section-3.3.2.4-5.5.1"><code>IV_4 = EDHOC_KDF(PRK_4e3m, 9, TH_4, iv_length)</code>.<a href="#section-3.3.2.4-5.5.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.3.2.4-6">Using the AEAD encryption algorithm, he ciphers <code>PLAINTEXT_4 = EAD_4</code> and sends it to the Initiator, along with <code>kem.ct_I</code>.
He then finishes the AKE by computing the final key <code>PRK_out</code>:<a href="#section-3.3.2.4-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.2.4-7.1">
                <p id="section-3.3.2.4-7.1.1"><code>PRK_out = EDHOC_KDF(PRK_4e3m, 7, TH_4, hash_length)</code>.<a href="#section-3.3.2.4-7.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
<div id="processing-message4">
<section id="section-3.3.2.5">
            <h5 id="name-processing-message_4">
<a href="#section-3.3.2.5" class="section-number selfRef">3.3.2.5. </a><a href="#name-processing-message_4" class="section-name selfRef">Processing <code>message_4</code></a>
            </h5>
<p id="section-3.3.2.5-1">In this situation the fourth message is mandatory. It is used to send the KEM ciphertext <code>kem.ct_I</code> to the Initiator (it cannot be shared before, since the Responder only learns the identity of the Initiator with the third message).<a href="#section-3.3.2.5-1" class="pilcrow">¶</a></p>
<p id="section-3.3.2.5-2">When receiving this last message, the Initiator computes the shared-secret <code>ss_I</code> thanks to the <code>KEM.Decapsulation</code> algorithm, and elements <code>kem.sk_I</code>, <code>kem.ct_I</code>.
After that, he can compute <code>TH_4</code>, <code>K_4</code>, <code>IV_4</code>, and decipher <code>CIPHERTEXT_4</code> thanks to the AEAD decryption algorithm. Once he had checked the well formedness of <code>PLAINTEXT_4</code>, he can finally compute <code>PRK_out</code> as the Responder did.<a href="#section-3.3.2.5-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="associated-key-derivation-schedule-1">
<section id="section-3.3.3">
          <h4 id="name-associated-key-derivation-sc">
<a href="#section-3.3.3" class="section-number selfRef">3.3.3. </a><a href="#name-associated-key-derivation-sc" class="section-name selfRef">Associated key derivation schedule</a>
          </h4>
<p id="section-3.3.3-1">In this section we present the key derivation schedule of the previously described protocol version.<a href="#section-3.3.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.3.3-2">
<pre>
          +--------------------------------+
          |TH_2=H(kem.ct_eph, H(message_1))|
          +------+----------------------+--+              PLAINTEXT_2
                 |                      |                        |
  +------+   +---+---+   +------+   +---+--+   +-----------+   +-+-+
  |ss_eph|--&gt;|Extract|--&gt;|PRK_2e|--&gt;|Expand|--&gt;|KEYSTREAM_2|--&gt;|XOR|
  +------+   +-------+   +---+--+   +---+--+   +-----------+   +-+-+
                             |                                   |
                             |                                   v
                             |                         +---------+--+
                             |                         |CIPHERTEXT_2|
                             |                         +------------+
                             |
                             |     +------+   +-----+   +-----------+
                             +-----|Expand|--&gt;|MAC_2|--&gt;|SIGNATURE_2|
                             |     +------+   +-----+   +-----------+
                             |
                             | +------------------------------------+
                             | |TH_3=H(TH_2, PLAINTEXT_2, ID_CRED_R)|
                             | +--------+---------------------------+
                             |          |
                             |          |                 PLAINTEXT_3
                             |          |                      |
                             |      +---+--+   +--------+   +--+-+
                             +------|Expand|--&gt;|K_3/IV_3|--&gt;|AEAD|
                             |      +---+--+   +--------+   +--+-+
                             |                                 |
                             |                                 v
                             |                         +-------+----+
                             |                         |CIPHERTEXT_3|
                             |                         +-------+----+
                             |                                 |
                             |                                 v
                             |                          +-----------+
                             |                          |SIGNATURE_3|
                             |                          +-----------+
                             |
           +---------+   +---+--+
           |SALT_4e3m|&lt;--|Expand|
           +---+-----+   +---+--+                         PLAINTEXT_4
               |                                               |
  +----+   +---+---+   +--------+   +------+   +--------+   +--+-+
  |ss_I|--&gt;|Extract|--&gt;|PRK_4e3m|--&gt;|Expand|--&gt;|K_4/IV_4|--&gt;|AEAD|
  +----+   +-------+   +---+----+   +---+--+   +--------+   +--+-+
                           |            |                      |
                           |            |                      v
                           |            |              +-------+----+
                           |            |              |CIPHERTEXT_4|
                           |            |              +------------+
                           |            |
                           |   +--------+---------------------------+
                           |   |TH_4=H(TH_3, PLAINTEXT_3, ID_CRED_I)|
                           |   +--------+---------------------------+
                           |            |
                           |        +---+--+   +-------+
                           +--------|Expand|--&gt;|PRK_out|
                                    +------+   +-------+
</pre><a href="#section-3.3.3-2" class="pilcrow">¶</a>
</div>
<p id="section-3.3.3-3">Figure 6: PQ-EDHOC, I KEM &amp; Signs - R Signs key derivation schedule.<a href="#section-3.3.3-3" class="pilcrow">¶</a></p>
<p id="section-3.3.3-4">So we can summarize the different computations as previously:<a href="#section-3.3.3-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.3.3-5">
<pre>
  PRK_2e      = EDHOC_Extract(TH_2, ss_eph);
  KEYSTREAM_2 = EDHOC_KDF(PRK_2e, 0, TH_2, plaintext_length);
  MAC_2       = EDHOC_KDF(PRK_2e, 2, context_2, mac_length_2)
              (with context_2 = C_R, ID_CRED_R, TH_2, EAD_2);
  K_3         = EDHOC_KDF(PRK_2e, 3, TH_3, key_length);
  IV_3        = EDHOC_KDF(PRK_2e, 4, TH_3, iv_length);
  SALT_4e3m   = EDHOC_KDF(PRK_2e, 5, TH_4, hash_length);
  PRK_4e3m    = EDHOC_Extract(SALT_4e3m, ss_I);
  K_4         = EDHOC_KDF(PRK_4e3m, 8, TH_4, key_length);
  IV_4        = EDHOC_KDF(PRK_4e3m, 9, TH_4, iv_length);
  PRK_out     = EDHOC_KDF(PRK_4e3m, 7, TH_4, hash_length).
</pre><a href="#section-3.3.3-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="additional-explanations-2">
<section id="section-3.3.4">
          <h4 id="name-additional-explanations-3">
<a href="#section-3.3.4" class="section-number selfRef">3.3.4. </a><a href="#name-additional-explanations-3" class="section-name selfRef">Additional explanations</a>
          </h4>
<p id="section-3.3.4-1">We detail here the main elements that differ from the original EDHOC protocol.<a href="#section-3.3.4-1" class="pilcrow">¶</a></p>
<div id="ephemeral-kem-2">
<section id="section-3.3.4.1">
            <h5 id="name-ephemeral-kem-3">
<a href="#section-3.3.4.1" class="section-number selfRef">3.3.4.1. </a><a href="#name-ephemeral-kem-3" class="section-name selfRef">Ephemeral KEM</a>
            </h5>
<p id="section-3.3.4.1-1">As previously explain the usual ephemeral Diffie-Hellman elements are replaced by an ephemeral KEM. In this protocol, it works exactly as we previously described.<a href="#section-3.3.4.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authentication-keys-2">
<section id="section-3.3.4.2">
            <h5 id="name-authentication-keys-3">
<a href="#section-3.3.4.2" class="section-number selfRef">3.3.4.2. </a><a href="#name-authentication-keys-3" class="section-name selfRef">Authentication keys</a>
            </h5>
<p id="section-3.3.4.2-1">For the Initiator, the authentication key <span class="bcp14">MUST</span> be: (1) a static KEM key pair <code>(kem.sk_I, kem.pk_I)</code> generated using a <code>KEM.KeyGen(k)</code> algorithm (where <code>k</code> is a security parameter) <strong>and</strong> (2) a static signing key pair <code>(sign.sk_I, sign.pk_I)</code> generated using a <code>DS.KeyGen(k)</code> algorithm (where <code>k</code> is a security parameter).<a href="#section-3.3.4.2-1" class="pilcrow">¶</a></p>
<p id="section-3.3.4.2-2">For the Responder, the authentication key <span class="bcp14">MUST</span> be a static signing key pair <code>(sign.sk_R, sign.pk_R)</code> generated using a <code>DS.KeyGen(k)</code> algorithm (where <code>k</code> is a security parameter).<a href="#section-3.3.4.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="key-derivation-2">
<section id="section-3.3.4.3">
            <h5 id="name-key-derivation-3">
<a href="#section-3.3.4.3" class="section-number selfRef">3.3.4.3. </a><a href="#name-key-derivation-3" class="section-name selfRef">Key derivation</a>
            </h5>
<p id="section-3.3.4.3-1">In this version of the protocol, the keys <code>PRK_2e</code> and <code>PRK_4e3m</code> are obtain thanks to EDHOC_Extract fonction:<a href="#section-3.3.4.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.4.3-2.1">
                <p id="section-3.3.4.3-2.1.1"><code>PRK_2e = EDHOC_Extract(TH_2, ss_eph)</code> --&gt; the salt <span class="bcp14">SHALL</span> be <code>TH_2</code> and the IKM <span class="bcp14">SHALL</span> be the ephemeral shared-secret <code>ss_eph</code>;<a href="#section-3.3.4.3-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.3.4.3-2.2">
                <p id="section-3.3.4.3-2.2.1"><code>PRK_4e3m = EDHOC_Extract(SALT_4e3m, ss_I)</code> --&gt; the salt <span class="bcp14">SHALL</span> be <code>SALT_4e3m</code> directly derived from <code>PRK_2e</code>, and the IKM <span class="bcp14">SHALL</span> be the 'static' shared-secret <code>ss_I</code>.<a href="#section-3.3.4.3-2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.3.4.3-3">Concerning <code>PRK_out</code>, here again, there is no modifications compared to the original EDHOC protocol.
We can note that in this two previous cases, the Key Derivation Schedule remains close to the standard EDHOC Key Derivation Schedule of method 1 and 2.<a href="#section-3.3.4.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="analysis-2">
<section id="section-3.3.5">
          <h4 id="name-analysis-3">
<a href="#section-3.3.5" class="section-number selfRef">3.3.5. </a><a href="#name-analysis-3" class="section-name selfRef">Analysis</a>
          </h4>
<p id="section-3.3.5-1">This is actually a mirror version of the previous protocol presented, in the sense that this time we assumed that the Responder has a pair of static signature keys <code>(sign.sk_R, sign.pk_R)</code> and that the Initiator has not only a pair of static signature keys <code>(sign.sk_I, sign.pk_I)</code> but also a pair of static KEM keys <code>(kem.sk_I, kem.pk_I)</code>.
For the same reasons, this is not an unusual case.<a href="#section-3.3.5-1" class="pilcrow">¶</a></p>
<p id="section-3.3.5-2">From a technical point of view, messages <code>message_1</code>,<code>message_2</code> and <code>message_4</code> do not differ from those proposed in <span>[<a href="#I-D.pocero-authkem-edhoc" class="cite xref">I-D.pocero-authkem-edhoc</a>]</span>. Here again, two major differences are worth noting regarding the messages.
Firstly, here we no more have a fifth mandatory message <code>message_5</code>. Secondly, our third message <code>message_3</code> contains an additional signature <code>SIGNATURE_3</code> (as this was the case for the previous protocol we propose, with <code>SIGNATURE_2</code>)(we will propose a byte analysis of this message later).
Finally, from a computational point of view, both the Initiator and the Responder no longer need to calculate the MAC <code>MAC_3</code>. In return, in the same vein, the Initiator must sign a message, and the Responder must verify this signature, in order to authenticate the Initiator, and send him the KEM ciphertext <code>kem.ct_I</code>.
Regarding the Key Derivation Schedule, aside from the IKM which adapts to post-quantum cryptographic material, we remain close to the one of EDHOC's method 2.
So compared to <span>[<a href="#I-D.pocero-authkem-edhoc" class="cite xref">I-D.pocero-authkem-edhoc</a>]</span>, we reduce the number of mandatory messages, from 5 to 4, and again we obtain a tradeoff between the size of messages, calculation capabilities, and the number of messages.<a href="#section-3.3.5-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="third-case-initiator-and-responder-kem-and-sign-version-1">
<section id="section-3.4">
        <h3 id="name-third-case-initiator-and-re">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-third-case-initiator-and-re" class="section-name selfRef">Third case: Initiator and Responder KEM and sign - version 1</a>
        </h3>
<p id="section-3.4-1">We now present the equivalent of EDHOC method 3, which is in our case, an hybridation of the previous cases. We propose two variant of this version. We start here with the first one, where the Initiator authenticates with a KEM and a signature, and the Responder with only a KEM. More specifically, this first version is a kind of hybrid between a protocol proposed in <span>[<a href="#I-D.pocero-authkem-edhoc" class="cite xref">I-D.pocero-authkem-edhoc</a>]</span> and one of the protocols we have proposed above.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<div id="protocol-overview-2">
<section id="section-3.4.1">
          <h4 id="name-protocol-overview-3">
<a href="#section-3.4.1" class="section-number selfRef">3.4.1. </a><a href="#name-protocol-overview-3" class="section-name selfRef">Protocol overview</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-3.4.1-1">
<pre>
  I                                                             R
 ---                                                           ---
  |          METHOD, SUITES_I, kem.pk_eph, C_I, EAD_1           |
  +-------------------------------------------------------------&gt;
  |                          message_1                          |
  |                                                             |
  |       kem.ct_eph, Enc(KEYSTREAM_2, ID_CRED_R, EAD_2)        |
  &lt;-------------------------------------------------------------+
  |                          message_2                          |
  |                                                             |
  |        kem.ct_R, AEAD(ID_CRED_I, EAD_3), Signature_3        |
  +-------------------------------------------------------------&gt;
  |                          message_3                          |
  |                                                             |
  |                kem.ct_I, AEAD(EAD_4, MAC_2)                 |
  &lt;-------------------------------------------------------------+
  |                          message_4                          |
</pre><a href="#section-3.4.1-1" class="pilcrow">¶</a>
</div>
<p id="section-3.4.1-2">Figure 7: PQ-EDHOC, I KEM &amp; Signs - R KEM message flow.<a href="#section-3.4.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="protocol-description-2">
<section id="section-3.4.2">
          <h4 id="name-protocol-description-3">
<a href="#section-3.4.2" class="section-number selfRef">3.4.2. </a><a href="#name-protocol-description-3" class="section-name selfRef">Protocol description</a>
          </h4>
<div id="formatting-and-sending-message1-3">
<section id="section-3.4.2.1">
            <h5 id="name-formatting-and-sending-message">
<a href="#section-3.4.2.1" class="section-number selfRef">3.4.2.1. </a><a href="#name-formatting-and-sending-message" class="section-name selfRef">Formatting and sending <code>message_1</code></a>
            </h5>
<p id="section-3.4.2.1-1">As for our previous protocol version, the first message (<code>message_1</code>) consists of:<a href="#section-3.4.2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4.2.1-2.1">
                <p id="section-3.4.2.1-2.1.1"><code>METHOD</code> --&gt; as specified in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span> it is an integer specifying the authentication method the Initiator wants to use;<a href="#section-3.4.2.1-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.4.2.1-2.2">
                <p id="section-3.4.2.1-2.2.1"><code>SUITES_I</code> --&gt; it consists of an ordered set of algorithms supported by the Initiator and formatted as specified in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>;<a href="#section-3.4.2.1-2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.4.2.1-2.3">
                <p id="section-3.4.2.1-2.3.1"><code>C_I</code> (and also as <code>C_R</code>, which will appears later) --&gt; the Connection Identifiers chosen by the Initiator (C_I) and by the Responder (<code>C_R</code>) as specified in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>;<a href="#section-3.4.2.1-2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.4.2.1-2.4">
                <p id="section-3.4.2.1-2.4.1"><code>EAD_1</code> (and also <code>EAD_2</code>, <code>EAD_3</code> and <code>EAD_4</code>, which will appear later) -&gt; External Authorization Data, respectively included in <code>message_1</code>, <code>message_2</code>, <code>message_3</code> (and optionally) <code>message_4</code>, and formatted as specified in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>;<a href="#section-3.4.2.1-2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.4.2.1-2.5">
                <p id="section-3.4.2.1-2.5.1"><code>kem.pk_eph</code> --&gt; the Ephemeral KEM public key generated by the Initiator.<a href="#section-3.4.2.1-2.5.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
<div id="processing-message1-formatting-and-sending-message2-3">
<section id="section-3.4.2.2">
            <h5 id="name-processing-message_1-formattin">
<a href="#section-3.4.2.2" class="section-number selfRef">3.4.2.2. </a><a href="#name-processing-message_1-formattin" class="section-name selfRef">Processing <code>message_1</code>, formatting and sending <code>message_2</code></a>
            </h5>
<p id="section-3.4.2.2-1">On the reception of the first message, the Responder proceeds as in the original EDHOC protocol with elements <code>METHOD</code>, <code>SUITES_I</code>, <code>C_I</code> and <code>EAD_1</code>.
In a second step, using <code>kem.pk_eph</code> and the <code>KEM.Encapsulation</code> algorithm, he computes the ephemeral ciphertext <code>kem.ct_eph</code> and the ephemeral shared-secret <code>ss_eph</code>.<a href="#section-3.4.2.2-1" class="pilcrow">¶</a></p>
<p id="section-3.4.2.2-2">The Responder selects its Connection Identifier <code>C_R</code> as specified in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>. He then computes:<a href="#section-3.4.2.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4.2.2-3.1">
                <p id="section-3.4.2.2-3.1.1"><code>TH_2 = H(kem.ct_eph, H(message_1))</code>;<a href="#section-3.4.2.2-3.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.4.2.2-3.2">
                <p id="section-3.4.2.2-3.2.1"><code>PRK_2e = EDHOC_Extract(TH_2, ss_eph)</code>;<a href="#section-3.4.2.2-3.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.4.2.2-3.3">
                <p id="section-3.4.2.2-3.3.1"><code>KEYSTREAM_2 = EDHOC_KDF(PRK_2e, 0, TH_2, plaintext_length)</code>.<a href="#section-3.4.2.2-3.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.4.2.2-4">In this version the Responder authenticates with the fourth mandatory message. So he directly assembles <code>PLAINTEXT_2</code>:<a href="#section-3.4.2.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4.2.2-5.1">
                <p id="section-3.4.2.2-5.1.1"><code>PLAINTEXT_2 = (C_R, ID_CRED_R, TH_2, EAD_2)</code><a href="#section-3.4.2.2-5.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.4.2.2-6">then ciphers this message :<a href="#section-3.4.2.2-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4.2.2-7.1">
                <p id="section-3.4.2.2-7.1.1"><code>CIPHERTEXT_2 = PLAINTEXT_2 XOR KEYSTREAM_2</code><a href="#section-3.4.2.2-7.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.4.2.2-8">and finally sends <code>message_2</code>composed of <code>CIPHERTEXT_2</code> and <code>kem.ct_eph</code>.<a href="#section-3.4.2.2-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="processing-message2-formatting-and-sending-message3-3">
<section id="section-3.4.2.3">
            <h5 id="name-processing-message_2-formattin">
<a href="#section-3.4.2.3" class="section-number selfRef">3.4.2.3. </a><a href="#name-processing-message_2-formattin" class="section-name selfRef">Processing <code>message_2</code>, formatting and sending <code>message_3</code></a>
            </h5>
<p id="section-3.4.2.3-1">On reception of the second message, the Initiator, using <code>kemp.ct_eph</code>, can compute the ephemeral shared-secret <code>ss_eph</code>. As the Responder did, he computes <code>TH_2</code>, <code>PRK_2e</code> and <code>KEYSTREAM_2</code>. He can now decipher and retrieve : <code>PLAINTEXT_2 = CIPHERTEXT_2 XOR KEYSTREAM_2</code>.<a href="#section-3.4.2.3-1" class="pilcrow">¶</a></p>
<p id="section-3.4.2.3-2">Thanks to <code>ID_CRED_R</code>, the Initiator obtains the long-term KEM public key of the Responder, <code>kem.pk_R</code>. He then uses the <code>KEM.Encapsulation</code> algorithm to generate <code>ss_R</code> and <code>kem.ct_R</code>.<a href="#section-3.4.2.3-2" class="pilcrow">¶</a></p>
<p id="section-3.4.2.3-3">He then computes the following elements:<a href="#section-3.4.2.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4.2.3-4.1">
                <p id="section-3.4.2.3-4.1.1"><code>SALT_3e2m = EDHOC_KDF(PRK_2e, 1, TH_2, hash_length)</code>;<a href="#section-3.4.2.3-4.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.4.2.3-4.2">
                <p id="section-3.4.2.3-4.2.1"><code>PRK_3e2m = EDHOC_Extract(SALT_3e2m, ss_R)</code>;<a href="#section-3.4.2.3-4.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.4.2.3-4.3">
                <p id="section-3.4.2.3-4.3.1"><code>TH_3 = H(TH_2, PLAINTEXT_2, ID_CRED_R)</code>;<a href="#section-3.4.2.3-4.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.4.2.3-4.4">
                <p id="section-3.4.2.3-4.4.1"><code>K_3 = EDHOC_KDF(PRK_3e2m, 3, TH_3, key_length)</code>;<a href="#section-3.4.2.3-4.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.4.2.3-4.5">
                <p id="section-3.4.2.3-4.5.1"><code>IV_3 = EDHOC_KDF(PRK_3e2m, 4, TH_3, iv_length)</code>.<a href="#section-3.4.2.3-4.5.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.4.2.3-5">He then forms <code>PLAINTEXT_3 = (ID_CRED_I, TH_3, EAD_3)</code> ciphers it with the AEAD encryption algorithm negociated in <code>SUITES_I</code>.<a href="#section-3.4.2.3-5" class="pilcrow">¶</a></p>
<p id="section-3.4.2.3-6">Then, in order to authenticate, he signs the ciphertext:<a href="#section-3.4.2.3-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4.2.3-7.1">
                <p id="section-3.4.2.3-7.1.1"><code>SIGNATURE_3 = DS.Sign(sign.sk_I, (CIPHERTEXT_3, sign_length))</code><a href="#section-3.4.2.3-7.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.4.2.3-8">where <code>sign.sk_I</code> is the long-term signing private key of the Initiator. The third message is then composed of:<a href="#section-3.4.2.3-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4.2.3-9.1">
                <p id="section-3.4.2.3-9.1.1"><code>kem.ct_R</code>;<a href="#section-3.4.2.3-9.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.4.2.3-9.2">
                <p id="section-3.4.2.3-9.2.1"><code>CIPHERTEXT_3</code>;<a href="#section-3.4.2.3-9.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.4.2.3-9.3">
                <p id="section-3.4.2.3-9.3.1"><code>SIGNATURE_3</code>.<a href="#section-3.4.2.3-9.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
<div id="processing-message3-formatting-and-sending-message4-1">
<section id="section-3.4.2.4">
            <h5 id="name-processing-message_3-formatt">
<a href="#section-3.4.2.4" class="section-number selfRef">3.4.2.4. </a><a href="#name-processing-message_3-formatt" class="section-name selfRef">Processing <code>message_3</code>, formatting and sending <code>message_4</code></a>
            </h5>
<p id="section-3.4.2.4-1">On reception of <code>message_3</code>, the Responder computes <code>TH_3</code>. He also used the <code>KEM.Decapsulation</code> algorithm with its long-term KEM private key <code>kem.sk_R</code> and the KEM ciphertext <code>kem.ct_R</code>, to obtain the shared-secret <code>ss_R</code>.<a href="#section-3.4.2.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4.2.4-2">He can now compute <code>SALT_3e2m</code>, <code>PRK_3e2m</code>, <code>K_3</code>, and <code>IV_3</code> as the Initiator did, and deciphers <code>CIPHERTEXT_3</code> with the AEAD decryption algorithm.
With <code>PLAINTEXT_3</code>, he obtains <code>kem.pk_I</code> and <code>sign.pk_I</code>, and verifies the signature:<a href="#section-3.4.2.4-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4.2.4-3.1">
                <p id="section-3.4.2.4-3.1.1"><code>DS.Verify(sign.pk_I, (CIPHERTEXT_3, sign_length), SIGNATURE_3)</code>.<a href="#section-3.4.2.4-3.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.4.2.4-4">If the verification algorithm returns 1, the Initiator is properly authenticated to the Initiator. Otherwise the Responder aborts.<a href="#section-3.4.2.4-4" class="pilcrow">¶</a></p>
<p id="section-3.4.2.4-5">He then uses the <code>KEM.Encapsulation</code> algorithm to generate <code>ss_I</code> and <code>kem.ct_I</code>.<a href="#section-3.4.2.4-5" class="pilcrow">¶</a></p>
<p id="section-3.4.2.4-6">Following that, he computes:<a href="#section-3.4.2.4-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4.2.4-7.1">
                <p id="section-3.4.2.4-7.1.1"><code>TH_4 = H(TH_3, PLAINTEXT_3, ID_CRED_I)</code>;<a href="#section-3.4.2.4-7.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.4.2.4-7.2">
                <p id="section-3.4.2.4-7.2.1"><code>SALT_4e3m = EDHOC_KDF(PRK_3e2m, 5, TH_4, hash_length)</code>;<a href="#section-3.4.2.4-7.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.4.2.4-7.3">
                <p id="section-3.4.2.4-7.3.1"><code>PRK_4e3m = EDHOC_Extract(SALT_4e3m, ss_I)</code>;<a href="#section-3.4.2.4-7.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.4.2.4-7.4">
                <p id="section-3.4.2.4-7.4.1"><code>K_4 = EDHOC_KDF(PRK_4e3m, 8, TH_4, key_length)</code>;<a href="#section-3.4.2.4-7.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.4.2.4-7.5">
                <p id="section-3.4.2.4-7.5.1"><code>IV_4 = EDHOC_KDF(PRK_4e3m, 9, TH_4, iv_length)</code>.<a href="#section-3.4.2.4-7.5.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.4.2.4-8">The Responder now needs to authenticate. For that, he computes a MAC <code>MAC_2</code>:<a href="#section-3.4.2.4-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4.2.4-9.1">
                <p id="section-3.4.2.4-9.1.1"><code>MAC_2 = EDHOC_KDF(PRK_4e3m, 2, C_R, ID_CRED_R, TH_4, EAD_4, mac_length_2)</code>.<a href="#section-3.4.2.4-9.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.4.2.4-10">Using the AEAD encryption algorithm, he ciphers <code>PLAINTEXT_4 = (EAD_4, MAC_2)</code> and sends it to the Initiator, along with <code>kem.ct_I</code>.
He then finishes the AKE by computing the final key <code>PRK_out</code>:<a href="#section-3.4.2.4-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4.2.4-11.1">
                <p id="section-3.4.2.4-11.1.1"><code>PRK_out = EDHOC_KDF(PRK_4e3m, 7, TH_4, hash_length)</code>.<a href="#section-3.4.2.4-11.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
<div id="processing-message4-1">
<section id="section-3.4.2.5">
            <h5 id="name-processing-message_4-2">
<a href="#section-3.4.2.5" class="section-number selfRef">3.4.2.5. </a><a href="#name-processing-message_4-2" class="section-name selfRef">Processing <code>message_4</code></a>
            </h5>
<p id="section-3.4.2.5-1">In this situation the fourth message is mandatory. It is used to send the KEM ciphertext <code>kem.ct_I</code> to the Initiator (it cannot be shared before, since the Responder only learns the identity of the Initiator with the third message).<a href="#section-3.4.2.5-1" class="pilcrow">¶</a></p>
<p id="section-3.4.2.5-2">When receiving this last message, the Initiator computes the shared-secret <code>ss_I</code> thanks to the <code>KEM.Decapsulation</code> algorithm, and elements <code>kem.sk_I</code>, <code>kem.ct_I</code>.
After that, he can compute <code>TH_4</code>, <code>K_4</code>, <code>IV_4</code>, and decipher <code>CIPHERTEXT_4</code> thanks to the AEAD decryption algorithm. Once he had checked the well formedness of <code>PLAINTEXT_4</code>, he can authenticate the Responder by computing <code>MAC_2</code> on its own and comparing with the one he finds in <code>PLAINTEXT_4</code>. If everything goes well, he finally computes <code>PRK_out</code> as the Responder did.<a href="#section-3.4.2.5-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="associated-key-derivation-schedule-2">
<section id="section-3.4.3">
          <h4 id="name-associated-key-derivation-sch">
<a href="#section-3.4.3" class="section-number selfRef">3.4.3. </a><a href="#name-associated-key-derivation-sch" class="section-name selfRef">Associated key derivation schedule</a>
          </h4>
<p id="section-3.4.3-1">In this section we present the key derivation schedule of the previously described protocol version.<a href="#section-3.4.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.4.3-2">
<pre>
          +--------------------------------+
          |TH_2=H(kem.ct_eph, H(message_1))|
          +------+----------------------+--+              PLAINTEXT_2
                 |                      |                        |
  +------+   +---+---+   +------+   +---+--+   +-----------+   +-+-+
  |ss_eph|--&gt;|Extract|--&gt;|PRK_2e|--&gt;|Expand|--&gt;|KEYSTREAM_2|--&gt;|XOR|
  +------+   +-------+   +---+--+   +---+--+   +-----------+   +-+-+
                             |                                   |
                             |                                   v
                             |                         +---------+--+
                             |                         |CIPHERTEXT_2|
                             |                         +------------+
           +---------+   +---+--+
           |SALT_3e2m|&lt;--|Expand|
           +---+-----+   +---+--+
               |               +------------------------------------+
               |               |TH_3=H(TH_2, PLAINTEXT_2, ID_CRED_R)|
               |               +-------+----------------------------+
               |                       |
               |                       |                  PLAINTEXT_3
               |                       |                       |
  +----+   +---+---+   +--------+   +--+---+   +--------+   +--+-+
  |ss_R|--&gt;|Extract|--&gt;|PRK_3e2m|--&gt;|Expand|--&gt;|K_3/IV_3|--&gt;|AEAD|
  +----+   +-------+   +---+----+   +---+--+   +--------+   +--+-+
                             |                                 |
                             |                                 v
                             |                         +-------+----+
                             |                         |CIPHERTEXT_3|
                             |                         +-------+----+
                             |                                 |
                             |                                 v
                             |                          +-----------+
                             |                          |SIGNATURE_3|
                             |                          +-----------+
           +---------+   +---+--+
           |SALT_4e3m|&lt;--|Expand|
           +---+-----+   +---+--+
               |
  +----+   +---+---+   +--------+   +------+   +-----+
  |ss_I|--&gt;|Extract|--&gt;|PRK_4e3m|--&gt;|Expand|--&gt;|MAC_2|
  +----+   +-------+   +---+----+   +------+   +-----+
                           |
                           |                              PLAINTEXT_4
                           |                                   |
                           |        +------+   +--------+   +--+-+
                           +--------|Expand|--&gt;|K_4/IV_4|--&gt;|AEAD|
                           |        +---+--+   +--------+   +--+-+
                           |            |                      |
                           |            |                      v
                           |            |              +-------+----+
                           |            |              |CIPHERTEXT_4|
                           |            |              +------------+
                           |            |
                           |   +--------+---------------------------+
                           |   |TH_4=H(TH_3, PLAINTEXT_3, ID_CRED_I)|
                           |   +--------+---------------------------+
                           |            |
                           |        +---+--+   +-------+
                           +--------|Expand|--&gt;|PRK_out|
                                    +------+   +-------+
</pre><a href="#section-3.4.3-2" class="pilcrow">¶</a>
</div>
<p id="section-3.4.3-3">Figure 8: PQ-EDHOC, I KEM &amp; Signs - R KEM key derivation schedule.<a href="#section-3.4.3-3" class="pilcrow">¶</a></p>
<p id="section-3.4.3-4">As above, we summarize the different computations:<a href="#section-3.4.3-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.4.3-5">
<pre>
  PRK_2e      = EDHOC_Extract(TH_2, ss_eph);
  KEYSTREAM_2 = EDHOC_KDF(PRK_2e, 0, TH_2, plaintext_length);
  SALT_3e2m   = EDHOC_KDF(PRK_2e, 1, TH_2, hash_length);
  PRK_3e2m    = EDHOC_Extract(SALT_3e2m, ss_R);
  K_3         = EDHOC_KDF(PRK_3e2m, 3, TH_3, key_length);
  IV_3        = EDHOC_KDF(PRK_3e2m, 4, TH_3, iv_length);
  SALT_4e3m   = EDHOC_KDF(PRK_3e2m, 5, TH_4, hash_length);
  PRK_4e3m    = EDHOC_Extract(SALT_4e3m, ss_I);
  K_4         = EDHOC_KDF(PRK_4e3m, 8, TH_4, key_length);
  IV_4        = EDHOC_KDF(PRK_4e3m, 9, TH_4, iv_length);
  MAC_2       = EDHOC_KDF(PRK_4e3m, 2, context_2, mac_length_2)
                (with context_2 = C_R, ID_CRED_R, TH_4, EAD_4);
  PRK_out     = EDHOC_KDF(PRK_4e3m, 7, TH_4, hash_length).
</pre><a href="#section-3.4.3-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="additional-explanations-3">
<section id="section-3.4.4">
          <h4 id="name-additional-explanations-4">
<a href="#section-3.4.4" class="section-number selfRef">3.4.4. </a><a href="#name-additional-explanations-4" class="section-name selfRef">Additional explanations</a>
          </h4>
<p id="section-3.4.4-1">We detail here the main elements that differ from the original EDHOC protocol.<a href="#section-3.4.4-1" class="pilcrow">¶</a></p>
<div id="ephemeral-kem-3">
<section id="section-3.4.4.1">
            <h5 id="name-ephemeral-kem-4">
<a href="#section-3.4.4.1" class="section-number selfRef">3.4.4.1. </a><a href="#name-ephemeral-kem-4" class="section-name selfRef">Ephemeral KEM</a>
            </h5>
<p id="section-3.4.4.1-1">As previously explain the usual ephemeral Diffie-Hellman elements are replaced by an ephemeral KEM. In this protocol, it works exactly as we previously described.<a href="#section-3.4.4.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authentication-keys-3">
<section id="section-3.4.4.2">
            <h5 id="name-authentication-keys-4">
<a href="#section-3.4.4.2" class="section-number selfRef">3.4.4.2. </a><a href="#name-authentication-keys-4" class="section-name selfRef">Authentication keys</a>
            </h5>
<p id="section-3.4.4.2-1">For the Initiator, the authentication key <span class="bcp14">MUST</span> be: (1) a static KEM key pair <code>(kem.sk_I, kem.pk_I)</code> generated using a <code>KEM.KeyGen(k)</code> algorithm (where <code>k</code> is a security parameter) <strong>and</strong> (2) a static signing key pair <code>(sign.sk_I, sign.pk_I)</code> generated using a <code>DS.KeyGen(k)</code> algorithm (where <code>k</code> is a security parameter).<a href="#section-3.4.4.2-1" class="pilcrow">¶</a></p>
<p id="section-3.4.4.2-2">For the Responder, the authentication key <span class="bcp14">MUST</span> be a static KEM key pair <code>(kem.sk_R, kem.pk_R)</code> generated using a <code>KEM.KeyGen(k)</code> algorithm (where <code>k</code> is a security parameter).<a href="#section-3.4.4.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="key-derivation-3">
<section id="section-3.4.4.3">
            <h5 id="name-key-derivation-4">
<a href="#section-3.4.4.3" class="section-number selfRef">3.4.4.3. </a><a href="#name-key-derivation-4" class="section-name selfRef">Key derivation</a>
            </h5>
<p id="section-3.4.4.3-1">In this version of the protocol, the keys <code>PRK_2e</code>, <code>PRK_3e2m</code> and <code>PRK_4e3m</code> are obtain thanks to EDHOC_Extract fonction:<a href="#section-3.4.4.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4.4.3-2.1">
                <p id="section-3.4.4.3-2.1.1"><code>PRK_2e = EDHOC_Extract(TH_2, ss_eph)</code> --&gt; the salt <span class="bcp14">SHALL</span> be <code>TH_2</code> and the IKM <span class="bcp14">SHALL</span> be the ephemeral shared-secret <code>ss_eph</code>;<a href="#section-3.4.4.3-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.4.4.3-2.2">
                <p id="section-3.4.4.3-2.2.1"><code>PRK_3e2m = EDHOC_Extract(SALT_3e2m, ss_R)</code> --&gt; the salt <span class="bcp14">SHALL</span> be <code>SALT_3e2m</code> directly derived from <code>PRK_2e</code>, and the IKM <span class="bcp14">SHALL</span> be the 'static' shared-secret <code>ss_R</code>.<a href="#section-3.4.4.3-2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.4.4.3-2.3">
                <p id="section-3.4.4.3-2.3.1"><code>PRK_4e3m = EDHOC_Extract(SALT_4e3m, ss_I)</code> --&gt; the salt <span class="bcp14">SHALL</span> be <code>SALT_4e3m</code> directly derived from <code>PRK_3e2m</code>, and the IKM <span class="bcp14">SHALL</span> be the 'static' shared-secret <code>ss_I</code>.<a href="#section-3.4.4.3-2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.4.4.3-3">Concerning <code>PRK_out</code>, here again, there is no modifications compared to the original EDHOC protocol.<a href="#section-3.4.4.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="analysis-3">
<section id="section-3.4.5">
          <h4 id="name-analysis-4">
<a href="#section-3.4.5" class="section-number selfRef">3.4.5. </a><a href="#name-analysis-4" class="section-name selfRef">Analysis</a>
          </h4>
<p id="section-3.4.5-1">This variant combines our PQ-EDHOC I KEM &amp; Signs - R Signs protocol with the version where the Initiator and Responder authenticate using a KEM, as presented in <span>[<a href="#I-D.pocero-authkem-edhoc" class="cite xref">I-D.pocero-authkem-edhoc</a>]</span>.
The advantage of this alternative is that it preserves Responder authentication via a KEM and simply asks the Initiator to sign its identity. Additionally, there is no longer need to calculate the MAC <code>MAC_3</code>.
In this variant, we assumed that the Initiator has a pair of static signature keys <code>(sign.sk_I, sign.pk_I)</code> and also a pair of static KEM keys <code>(kem.sk_I, kem.pk_I)</code>, and that the Responder has only a pair of static KEM keys <code>(kem.sk_R, kem.pk_R)</code>. As already explain, this is not an unusual case.
From a technical point of view, messages <code>message_1</code>,<code>message_2</code> and <code>message_4</code> do not differ from those proposed in <span>[<a href="#I-D.pocero-authkem-edhoc" class="cite xref">I-D.pocero-authkem-edhoc</a>]</span>. Again, two major differences are worth noting regarding the messages.
Firstly, here we no more have a fifth mandatory message <code>message_5</code>. Secondly, our third message <code>message_3</code> contains an additional signature <code>SIGNATURE_3</code> (as this was the case for protocols that we have proposed above, with <code>SIGNATURE_2</code> or <code>SIGNATURE_3</code>)(we will propose a byte analysis of this message later).
Finally, from a computational point of view, both the Initiator and the Responder no longer need to calculate the MAC <code>MAC_3</code>. In return, here again, the Initiator must sign a message, and the Responder must verify this signature, in order to authenticate the Initiator, and send him the KEM ciphertext <code>kem.ct_I</code>.
Regarding the Key Derivation Schedule, aside from the IKM which adapts to post-quantum cryptographic material, we remain close to the one of EDHOC's method 3.
So compared to <span>[<a href="#I-D.pocero-authkem-edhoc" class="cite xref">I-D.pocero-authkem-edhoc</a>]</span>, we reduce the number of mandatory messages, from 5 to 4, and again we obtain a tradeoff between the size of messages, calculation capabilities, and the number of messages.<a href="#section-3.4.5-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="third-case-initiator-and-responder-kem-and-sign-version-2">
<section id="section-3.5">
        <h3 id="name-third-case-initiator-and-res">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-third-case-initiator-and-res" class="section-name selfRef">Third case: Initiator and Responder KEM and sign - version 2</a>
        </h3>
<p id="section-3.5-1">We now present the second variant of the equivalent of EDHOC method 3. In this situation both the Initiator and the Responder authenticate with a KEM and a signature, which makes this protocol a hybrid of two of the protocols we presented previously.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<div id="protocol-overview-3">
<section id="section-3.5.1">
          <h4 id="name-protocol-overview-4">
<a href="#section-3.5.1" class="section-number selfRef">3.5.1. </a><a href="#name-protocol-overview-4" class="section-name selfRef">Protocol overview</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-3.5.1-1">
<pre>
  I                                                             R
 ---                                                           ---
  |          METHOD, SUITES_I, kem.pk_eph, C_I, EAD_1           |
  +-------------------------------------------------------------&gt;
  |                          message_1                          |
  |                                                             |
  | kem.ct_eph, Enc(KEYSTREAM_2, ID_CRED_R, EAD_2), SIGNATURE_2 |
  &lt;-------------------------------------------------------------+
  |                          message_2                          |
  |                                                             |
  |        kem.ct_R, AEAD(ID_CRED_I, EAD_3), Signature_3        |
  +-------------------------------------------------------------&gt;
  |                          message_3                          |
  |                                                             |
  |                    kem.ct_I, AEAD(EAD_4)                    |
  &lt;-------------------------------------------------------------+
  |                          message_4                          |
</pre><a href="#section-3.5.1-1" class="pilcrow">¶</a>
</div>
<p id="section-3.5.1-2">Figure 9: PQ-EDHOC, I KEM &amp; Signs - R KEM &amp; Signs message flow.<a href="#section-3.5.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="protocol-description-3">
<section id="section-3.5.2">
          <h4 id="name-protocol-description-4">
<a href="#section-3.5.2" class="section-number selfRef">3.5.2. </a><a href="#name-protocol-description-4" class="section-name selfRef">Protocol description</a>
          </h4>
<div id="formatting-and-sending-message1-4">
<section id="section-3.5.2.1">
            <h5 id="name-formatting-and-sending-message_">
<a href="#section-3.5.2.1" class="section-number selfRef">3.5.2.1. </a><a href="#name-formatting-and-sending-message_" class="section-name selfRef">Formatting and sending <code>message_1</code></a>
            </h5>
<p id="section-3.5.2.1-1">As for our previous protocol version, the first message (<code>message_1</code>) consists of:<a href="#section-3.5.2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.2.1-2.1">
                <p id="section-3.5.2.1-2.1.1"><code>METHOD</code> --&gt; as specified in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span> it is an integer specifying the authentication method the Initiator wants to use;<a href="#section-3.5.2.1-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.5.2.1-2.2">
                <p id="section-3.5.2.1-2.2.1"><code>SUITES_I</code> --&gt; it consists of an ordered set of algorithms supported by the Initiator and formatted as specified in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>;<a href="#section-3.5.2.1-2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.5.2.1-2.3">
                <p id="section-3.5.2.1-2.3.1"><code>C_I</code> (and also as <code>C_R</code>, which will appears later) --&gt; the Connection Identifiers chosen by the Initiator (C_I) and by the Responder (<code>C_R</code>) as specified in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>;<a href="#section-3.5.2.1-2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.5.2.1-2.4">
                <p id="section-3.5.2.1-2.4.1"><code>EAD_1</code> (and also <code>EAD_2</code>, <code>EAD_3</code> and <code>EAD_4</code>, which will appear later) -&gt; External Authorization Data, respectively included in <code>message_1</code>, <code>message_2</code>, <code>message_3</code> (and optionally) <code>message_4</code>, and formatted as specified in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>;<a href="#section-3.5.2.1-2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.5.2.1-2.5">
                <p id="section-3.5.2.1-2.5.1"><code>kem.pk_eph</code> --&gt; the Ephemeral KEM public key generated by the Initiator.<a href="#section-3.5.2.1-2.5.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
<div id="processing-message1-formatting-and-sending-message2-4">
<section id="section-3.5.2.2">
            <h5 id="name-processing-message_1-formatting">
<a href="#section-3.5.2.2" class="section-number selfRef">3.5.2.2. </a><a href="#name-processing-message_1-formatting" class="section-name selfRef">Processing <code>message_1</code>, formatting and sending <code>message_2</code></a>
            </h5>
<p id="section-3.5.2.2-1">On the reception of the first message, the Responder proceeds as in the original EDHOC protocol with elements <code>METHOD</code>, <code>SUITES_I</code>, <code>C_I</code> and <code>EAD_1</code>.
In a second step, using <code>kem.pk_eph</code> and the <code>KEM.Encapsulation</code> algorithm, he computes the ephemeral ciphertext <code>kem.ct_eph</code> and the ephemeral shared-secret <code>ss_eph</code>.<a href="#section-3.5.2.2-1" class="pilcrow">¶</a></p>
<p id="section-3.5.2.2-2">The Responder selects its Connection Identifier <code>C_R</code> as specified in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>. He then computes:<a href="#section-3.5.2.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.2.2-3.1">
                <p id="section-3.5.2.2-3.1.1"><code>TH_2 = H(kem.ct_eph, H(message_1))</code>;<a href="#section-3.5.2.2-3.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.5.2.2-3.2">
                <p id="section-3.5.2.2-3.2.1"><code>PRK_2e = EDHOC_Extract(TH_2, ss_eph)</code>;<a href="#section-3.5.2.2-3.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.5.2.2-3.3">
                <p id="section-3.5.2.2-3.3.1"><code>KEYSTREAM_2 = EDHOC_KDF(PRK_2e, 0, TH_2, plaintext_length)</code>.<a href="#section-3.5.2.2-3.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.5.2.2-4">In this version, the Responder authenticates with <code>message_2</code> thanks to a signature. So he assembles <code>PLAINTEXT_2</code>:<a href="#section-3.5.2.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.2.2-5.1">
                <p id="section-3.5.2.2-5.1.1"><code>PLAINTEXT_2 = (C_R, ID_CRED_R, TH_2, EAD_2)</code><a href="#section-3.5.2.2-5.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.5.2.2-6">then ciphers this message :<a href="#section-3.5.2.2-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.2.2-7.1">
                <p id="section-3.5.2.2-7.1.1"><code>CIPHERTEXT_2 = PLAINTEXT_2 XOR KEYSTREAM_2</code><a href="#section-3.5.2.2-7.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.5.2.2-8">and finally signs this ciphertext:<a href="#section-3.5.2.2-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.2.2-9.1">
                <p id="section-3.5.2.2-9.1.1"><code>SIGNATURE_2 = DS.Sign(sign.sk_R, (CIPHERTEXT_2, sign_length))</code><a href="#section-3.5.2.2-9.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.5.2.2-10">where <code>sign.sk_R</code> is the long-term signing private key of the Responder.<a href="#section-3.5.2.2-10" class="pilcrow">¶</a></p>
<p id="section-3.5.2.2-11">So the second message then consists of:<a href="#section-3.5.2.2-11" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.2.2-12.1">
                <p id="section-3.5.2.2-12.1.1"><code>kem.ct_eph</code> --&gt; the ephemeral ciphertext obtained with <code>kem.pk_eph</code>;<a href="#section-3.5.2.2-12.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.5.2.2-12.2">
                <p id="section-3.5.2.2-12.2.1"><code>CIPHERTEXT_2</code>;<a href="#section-3.5.2.2-12.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.5.2.2-12.3">
                <p id="section-3.5.2.2-12.3.1"><code>SIGNATURE_2</code>.<a href="#section-3.5.2.2-12.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
<div id="processing-message2-formatting-and-sending-message3-4">
<section id="section-3.5.2.3">
            <h5 id="name-processing-message_2-formatting">
<a href="#section-3.5.2.3" class="section-number selfRef">3.5.2.3. </a><a href="#name-processing-message_2-formatting" class="section-name selfRef">Processing <code>message_2</code>, formatting and sending <code>message_3</code></a>
            </h5>
<p id="section-3.5.2.3-1">On reception of the second message, the Initiator, using <code>kemp.ct_eph</code>, can compute the ephemeral shared-secret <code>ss_eph</code>. As the Responder did, he computes <code>TH_2</code>, <code>PRK_2e</code> and <code>KEYSTREAM_2</code>. He can now decipher and retrieve : <code>PLAINTEXT_2 = CIPHERTEXT_2 XOR KEYSTREAM_2</code>.<a href="#section-3.5.2.3-1" class="pilcrow">¶</a></p>
<p id="section-3.5.2.3-2">Thanks to <code>ID_CRED_R</code>, the Initiator obtains the long-term public keys of the Responder, <code>kemp.pk_R</code> and <code>sign.pk_R</code>.
At first, he checks the validity of the signature of the Responder:<a href="#section-3.5.2.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.2.3-3.1">
                <p id="section-3.5.2.3-3.1.1"><code>DS.Verify(sign.pk_R, (CIPHERTEXT_2, sign_length), SIGNATURE_2)</code>.<a href="#section-3.5.2.3-3.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.5.2.3-4">If the verification algorithm returns 1, the Initiator properly authenticated the Responder. Otherwise he aborts.<a href="#section-3.5.2.3-4" class="pilcrow">¶</a></p>
<p id="section-3.5.2.3-5">Using the KEM encapsulation algorithm <code>KEM.Encapsulation</code>, and the long-term input material <code>kem.pk_R</code> of the Responder, the Initiator generated the pair <code>(ss_R, kem.ct_R)</code>.<a href="#section-3.5.2.3-5" class="pilcrow">¶</a></p>
<p id="section-3.5.2.3-6">The shared-secret <code>ss_R</code> will then serve as IKM for the computation of <code>PRK_3e2m</code>:<a href="#section-3.5.2.3-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.2.3-7.1">
                <p id="section-3.5.2.3-7.1.1"><code>SALT_3e2m = EDHOC_KDF(PRK_2e, 1, TH_2, hash_length)</code>;<a href="#section-3.5.2.3-7.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.5.2.3-7.2">
                <p id="section-3.5.2.3-7.2.1"><code>PRK_3e2m = EDHOC_Extract(SALT_3e2m, ss_R)</code>.<a href="#section-3.5.2.3-7.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.5.2.3-8">It is now the turn of the Initiator to authenticate himself. To do so, he computes the following elements:<a href="#section-3.5.2.3-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.2.3-9.1">
                <p id="section-3.5.2.3-9.1.1"><code>TH_3 = H(TH_2, PLAINTEXT_2, ID_CRED_R)</code>;<a href="#section-3.5.2.3-9.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.5.2.3-9.2">
                <p id="section-3.5.2.3-9.2.1"><code>K_3 = EDHOC_KDF(PRK_3e2m, 3, TH_3, key_length)</code>;<a href="#section-3.5.2.3-9.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.5.2.3-9.3">
                <p id="section-3.5.2.3-9.3.1"><code>IV_3 = EDHOC_KDF(PRK_3e2m, 4, TH_3, iv_length)</code>;<a href="#section-3.5.2.3-9.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.5.2.3-10">assembles <code>PLAINTEXT_3 = (ID_CRED_I, TH_3, EAD_3)</code>, and ciphers <code>PLAINTEXT_3</code> with the AEAD encryption algorithm negociated in <code>SUITES_I</code>.<a href="#section-3.5.2.3-10" class="pilcrow">¶</a></p>
<p id="section-3.5.2.3-11">Then comes the signature:<a href="#section-3.5.2.3-11" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.2.3-12.1">
                <p id="section-3.5.2.3-12.1.1"><code>SIGNATURE_3 = DS.Sign(sign.sk_I, (CIPHERTEXT_3, sign_length))</code><a href="#section-3.5.2.3-12.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.5.2.3-13">where <code>sign.sk_I</code> is the long-term signing private key of the Initiator.<a href="#section-3.5.2.3-13" class="pilcrow">¶</a></p>
<p id="section-3.5.2.3-14">The third message is then composed of:<a href="#section-3.5.2.3-14" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.2.3-15.1">
                <p id="section-3.5.2.3-15.1.1"><code>kem.ct_R</code>;<a href="#section-3.5.2.3-15.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.5.2.3-15.2">
                <p id="section-3.5.2.3-15.2.1"><code>CIPHERTEXT_3</code>;<a href="#section-3.5.2.3-15.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.5.2.3-15.3">
                <p id="section-3.5.2.3-15.3.1"><code>SIGNATURE_3</code>.<a href="#section-3.5.2.3-15.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
<div id="processing-message3-formatting-and-sending-message4-2">
<section id="section-3.5.2.4">
            <h5 id="name-processing-message_3-formatti">
<a href="#section-3.5.2.4" class="section-number selfRef">3.5.2.4. </a><a href="#name-processing-message_3-formatti" class="section-name selfRef">Processing <code>message_3</code>, formatting and sending <code>message_4</code></a>
            </h5>
<p id="section-3.5.2.4-1">On reception of <code>message_3</code>, the Responder computes <code>TH_3</code>, <code>K_3</code> and <code>IV_3</code>, and deciphers <code>CIPHERTEXT_3</code> with the AEAD decryption algorithm.
With <code>PLAINTEXT_3</code>, he obtains the Initiator's long-term public keys <code>kem.pk_I</code> and <code>sign.pk_I</code>, and so he verifies the signature:<a href="#section-3.5.2.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.2.4-2.1">
                <p id="section-3.5.2.4-2.1.1"><code>DS.Verify(sign.pk_I, (CIPHERTEXT_3, sign_length), SIGNATURE_3)</code>.<a href="#section-3.5.2.4-2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.5.2.4-3">If the verification algorithm returns 1, the Initiator is properly authenticated to the Initiator. Otherwise the Responder aborts.
He then uses the <code>KEM.Encapsulation</code> algorithm to generate <code>ss_I</code> and <code>kem.ct_I</code>.<a href="#section-3.5.2.4-3" class="pilcrow">¶</a></p>
<p id="section-3.5.2.4-4">Following that, he computes:<a href="#section-3.5.2.4-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.2.4-5.1">
                <p id="section-3.5.2.4-5.1.1"><code>TH_4 = H(TH_3, PLAINTEXT_3, ID_CRED_I)</code>;<a href="#section-3.5.2.4-5.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.5.2.4-5.2">
                <p id="section-3.5.2.4-5.2.1"><code>SALT_4e3m = EDHOC_KDF(PRK_3e2m, 5, TH_4, hash_length)</code>;<a href="#section-3.5.2.4-5.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.5.2.4-5.3">
                <p id="section-3.5.2.4-5.3.1"><code>PRK_4e3m = EDHOC_Extract(SALT_4e3m, ss_I)</code>;<a href="#section-3.5.2.4-5.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.5.2.4-5.4">
                <p id="section-3.5.2.4-5.4.1"><code>K_4 = EDHOC_KDF(PRK_4e3m, 8, TH_4, key_length)</code>;<a href="#section-3.5.2.4-5.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.5.2.4-5.5">
                <p id="section-3.5.2.4-5.5.1"><code>IV_4 = EDHOC_KDF(PRK_4e3m, 9, TH_4, iv_length)</code>.<a href="#section-3.5.2.4-5.5.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.5.2.4-6">Using the AEAD encryption algorithm, he ciphers <code>PLAINTEXT_4 = EAD_4</code> and sends it to the Initiator, along with <code>kem.ct_I</code>.
He then finishes the AKE by computing the final key <code>PRK_out</code>:<a href="#section-3.5.2.4-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.2.4-7.1">
                <p id="section-3.5.2.4-7.1.1"><code>PRK_out = EDHOC_KDF(PRK_3e2m, 7, TH_4, hash_length)</code>.<a href="#section-3.5.2.4-7.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
<div id="processing-message4-2">
<section id="section-3.5.2.5">
            <h5 id="name-processing-message_4-3">
<a href="#section-3.5.2.5" class="section-number selfRef">3.5.2.5. </a><a href="#name-processing-message_4-3" class="section-name selfRef">Processing <code>message_4</code></a>
            </h5>
<p id="section-3.5.2.5-1">In this situation the fourth message is mandatory. It is used to send the KEM ciphertext <code>kem.ct_I</code> to the Initiator (it cannot be shared before, since the Responder only learns the identity of the Initiator with the third message).<a href="#section-3.5.2.5-1" class="pilcrow">¶</a></p>
<p id="section-3.5.2.5-2">When receiving this last message, the Initiator computes the shared-secret <code>ss_I</code> thanks to the <code>KEM.Decapsulation</code> algorithm, and elements <code>kem.sk_I</code>, <code>kem.ct_I</code>.
After that, he can compute <code>TH_4</code>, <code>K_4</code>, <code>IV_4</code>, and decipher <code>CIPHERTEXT_4</code> thanks to the AEAD decryption algorithm. Once he had checked the well formedness of <code>PLAINTEXT_4</code>, he can finally compute <code>PRK_out</code> as the Responder did.<a href="#section-3.5.2.5-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="associated-key-derivation-schedule-3">
<section id="section-3.5.3">
          <h4 id="name-associated-key-derivation-sche">
<a href="#section-3.5.3" class="section-number selfRef">3.5.3. </a><a href="#name-associated-key-derivation-sche" class="section-name selfRef">Associated key derivation schedule</a>
          </h4>
<p id="section-3.5.3-1">In this section we present the key derivation schedule of the previously described protocol version.<a href="#section-3.5.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.5.3-2">
<pre>
          +--------------------------------+
          |TH_2=H(kem.ct_eph, H(message_1))|
          +------+----------------------+--+              PLAINTEXT_2
                 |                      |                        |
  +------+   +---+---+   +------+   +---+--+   +-----------+   +-+-+
  |ss_eph|--&gt;|Extract|--&gt;|PRK_2e|--&gt;|Expand|--&gt;|KEYSTREAM_2|--&gt;|XOR|
  +------+   +-------+   +---+--+   +---+--+   +-----------+   +-+-+
                             |                                   |
                             |                                   v
                             |                         +---------+--+
                             |                         |CIPHERTEXT_2|
                             |                         +---------+--+
                             |                                   |
                             |                                   v
                             |                          +-----------+
                             |                          |SIGNATURE_2|
                             |                          +-----------+
                             |
           +---------+   +---+--+
           |SALT_3e2m|&lt;--|Expand|
           +---+-----+   +---+--+
               |               +------------------------------------+
               |               |TH_3=H(TH_2, PLAINTEXT_2, ID_CRED_R)|
               |               +-------+----------------------------+
               |                       |
               |                       |                  PLAINTEXT_3
               |                       |                       |
  +----+   +---+---+   +--------+   +--+---+   +--------+   +--+-+
  |ss_R|--&gt;|Extract|--&gt;|PRK_3e2m|--&gt;|Expand|--&gt;|K_3/IV_3|--&gt;|AEAD|
  +----+   +-------+   +---+----+   +---+--+   +--------+   +--+-+
                             |                                 |
                             |                                 v
                             |                         +-------+----+
                             |                         |CIPHERTEXT_3|
                             |                         +-------+----+
                             |                                 |
                             |                                 v
                             |                          +-----------+
                             |                          |SIGNATURE_3|
                             |                          +-----------+
           +---------+   +---+--+
           |SALT_4e3m|&lt;--|Expand|
           +---+-----+   +---+--+                         PLAINTEXT_4
               |                                               |
  +----+   +---+---+   +--------+   +------+   +--------+   +--+-+
  |ss_I|--&gt;|Extract|--&gt;|PRK_4e3m|--&gt;|Expand|--&gt;|K_4/IV_4|--&gt;|AEAD|
  +----+   +-------+   +---+----+   +---+--+   +--------+   +--+-+
                           |            |                      |
                           |            |                      v
                           |            |              +-------+----+
                           |            |              |CIPHERTEXT_4|
                           |            |              +------------+
                           |            |
                           |   +--------+---------------------------+
                           |   |TH_4=H(TH_3, PLAINTEXT_3, ID_CRED_I)|
                           |   +--------+---------------------------+
                           |            |
                           |        +---+--+   +-------+
                           +--------|Expand|--&gt;|PRK_out|
                                    +------+   +-------+
</pre><a href="#section-3.5.3-2" class="pilcrow">¶</a>
</div>
<p id="section-3.5.3-3">Figure 8: PQ-EDHOC, I KEM &amp; Signs - R KEM &amp; Sings key derivation schedule.<a href="#section-3.5.3-3" class="pilcrow">¶</a></p>
<p id="section-3.5.3-4">Here, we summarize the different computations:<a href="#section-3.5.3-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.5.3-5">
<pre>
  PRK_2e      = EDHOC_Extract(TH_2, ss_eph);
  KEYSTREAM_2 = EDHOC_KDF(PRK_2e, 0, TH_2, plaintext_length);
  SALT_3e2m   = EDHOC_KDF(PRK_2e, 1, TH_2, hash_length);
  PRK_3e2m    = EDHOC_Extract(SALT_3e2m, ss_R);
  K_3         = EDHOC_KDF(PRK_3e2m, 3, TH_3, key_length);
  IV_3        = EDHOC_KDF(PRK_3e2m, 4, TH_3, iv_length);
  SALT_4e3m   = EDHOC_KDF(PRK_3e2m, 5, TH_4, hash_length);
  PRK_4e3m    = EDHOC_Extract(SALT_4e3m, ss_I);
  K_4         = EDHOC_KDF(PRK_4e3m, 8, TH_4, key_length);
  IV_4        = EDHOC_KDF(PRK_4e3m, 9, TH_4, iv_length);
  PRK_out     = EDHOC_KDF(PRK_4e3m, 7, TH_4, hash_length).
</pre><a href="#section-3.5.3-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="additional-explanations-4">
<section id="section-3.5.4">
          <h4 id="name-additional-explanations-5">
<a href="#section-3.5.4" class="section-number selfRef">3.5.4. </a><a href="#name-additional-explanations-5" class="section-name selfRef">Additional explanations</a>
          </h4>
<p id="section-3.5.4-1">We detail here the main elements that differ from the original EDHOC protocol.<a href="#section-3.5.4-1" class="pilcrow">¶</a></p>
<div id="ephemeral-kem-4">
<section id="section-3.5.4.1">
            <h5 id="name-ephemeral-kem-5">
<a href="#section-3.5.4.1" class="section-number selfRef">3.5.4.1. </a><a href="#name-ephemeral-kem-5" class="section-name selfRef">Ephemeral KEM</a>
            </h5>
<p id="section-3.5.4.1-1">As previously explain the usual ephemeral Diffie-Hellman elements are replaced by an ephemeral KEM. In this protocol, it works exactly as we previously described.<a href="#section-3.5.4.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authentication-keys-4">
<section id="section-3.5.4.2">
            <h5 id="name-authentication-keys-5">
<a href="#section-3.5.4.2" class="section-number selfRef">3.5.4.2. </a><a href="#name-authentication-keys-5" class="section-name selfRef">Authentication keys</a>
            </h5>
<p id="section-3.5.4.2-1">For the Initiator, the authentication key <span class="bcp14">MUST</span> be: (1) a static KEM key pair <code>(kem.sk_I, kem.pk_I)</code> generated using a <code>KEM.KeyGen(k)</code> algorithm (where <code>k</code> is a security parameter) <strong>and</strong> (2) a static signing key pair <code>(sign.sk_I, sign.pk_I)</code> generated using a <code>DS.KeyGen(k)</code> algorithm (where <code>k</code> is a security parameter).<a href="#section-3.5.4.2-1" class="pilcrow">¶</a></p>
<p id="section-3.5.4.2-2">For the Responder, the authentication key <span class="bcp14">MUST</span> be: (1) a static KEM key pair <code>(kem.sk_R, kem.pk_R)</code> generated using a <code>KEM.KeyGen(k)</code> algorithm (where <code>k</code> is a security parameter) <strong>and</strong> (2) a static signing key pair <code>(sign.sk_R, sign.pk_R)</code> generated using a <code>DS.KeyGen(k)</code> algorithm (where <code>k</code> is a security parameter).<a href="#section-3.5.4.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="key-derivation-4">
<section id="section-3.5.4.3">
            <h5 id="name-key-derivation-5">
<a href="#section-3.5.4.3" class="section-number selfRef">3.5.4.3. </a><a href="#name-key-derivation-5" class="section-name selfRef">Key derivation</a>
            </h5>
<p id="section-3.5.4.3-1">In this version of the protocol, the keys <code>PRK_2e</code>, <code>PRK_3e2m</code> and <code>PRK_4e3m</code> are obtain thanks to EDHOC_Extract fonction:<a href="#section-3.5.4.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.4.3-2.1">
                <p id="section-3.5.4.3-2.1.1"><code>PRK_2e = EDHOC_Extract(TH_2, ss_eph)</code> --&gt; the salt <span class="bcp14">SHALL</span> be <code>TH_2</code> and the IKM <span class="bcp14">SHALL</span> be the ephemeral shared-secret <code>ss_eph</code>;<a href="#section-3.5.4.3-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.5.4.3-2.2">
                <p id="section-3.5.4.3-2.2.1"><code>PRK_3e2m = EDHOC_Extract(SALT_3e2m, ss_R)</code> --&gt; the salt <span class="bcp14">SHALL</span> be <code>SALT_3e2m</code> directly derived from <code>PRK_2e</code>, and the IKM <span class="bcp14">SHALL</span> be the 'static' shared-secret <code>ss_R</code>.<a href="#section-3.5.4.3-2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.5.4.3-2.3">
                <p id="section-3.5.4.3-2.3.1"><code>PRK_4e3m = EDHOC_Extract(SALT_4e3m, ss_I)</code> --&gt; the salt <span class="bcp14">SHALL</span> be <code>SALT_4e3m</code> directly derived from <code>PRK_3e2m</code>, and the IKM <span class="bcp14">SHALL</span> be the 'static' shared-secret <code>ss_I</code>.<a href="#section-3.5.4.3-2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.5.4.3-3">Concerning <code>PRK_out</code>, here again, there is no modifications compared to the original EDHOC protocol.<a href="#section-3.5.4.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="analysis-4">
<section id="section-3.5.5">
          <h4 id="name-analysis-5">
<a href="#section-3.5.5" class="section-number selfRef">3.5.5. </a><a href="#name-analysis-5" class="section-name selfRef">Analysis</a>
          </h4>
<p id="section-3.5.5-1">We conclude all these descriptions, with a last one variant which combines our PQ-EDHOC I KEM &amp; Signs - R Signs protocol with our PQ-EDHOC I Signs - R KEM &amp; Signs protocol. In this situation, both the Initiator and the Responder will authenticate using a signature, and there will be no longer MACs <code>MAC_2</code> and <code>MAC_3</code> to compute.
In this variant, we assumed that the Initiator has a pair of static signature keys <code>(sign.sk_I, sign.pk_I)</code> and also a pair of static KEM keys <code>(kem.sk_I, kem.pk_I)</code>, and that the Responder has a pair of static signature keys <code>(sign.sk_R, sign.pk_R)</code> and also a pair of static KEM keys <code>(kem.sk_R, kem.pk_R)</code>. As already explain, this is not an unusual case.
From a technical point of view, only message <code>message_1</code> remains unchanged as the one proposed in <span>[<a href="#I-D.pocero-authkem-edhoc" class="cite xref">I-D.pocero-authkem-edhoc</a>]</span>. Here, four major differences are worth noting regarding the messages.
Firstly, here we no more have a fifth mandatory message <code>message_5</code>. Secondly, our second and third messages <code>message_2</code> and <code>message_3</code> contain each an additional signature <code>SIGNATURE_2</code> and <code>SIGNATURE_3</code> respectively. Moreover, the plaintext <code>PLAINTEXT_4</code> no longer includes <code>MAC_2</code>, which implies that the ciphertext <code>CIPHERTEXT_4</code> is lighter, and so is our fourth message <code>message_4</code> (we will propose a byte analysis of these messages later).
Finally, from a computational point of view, both the Initiator and the Responder no longer need to calculate the MACs <code>MAC_2</code> and <code>MAC_3</code>. In return, both the Initiator and the Responder must sign a message and verify signature, in order to authenticate themselves.
This allows the Initiator to authenticate the Responder directly when he receives the second message, and vice versa for the Responder when he receives the third message. That is why we no longer need <code>MAC_2</code> and <code>MAC_3</code> in the fourth and fifth messages.
Regarding the Key Derivation Schedule, aside from the IKM which adapts to post-quantum cryptographic material, we remain close to the one of EDHOC's method 3.
So compared to <span>[<a href="#I-D.pocero-authkem-edhoc" class="cite xref">I-D.pocero-authkem-edhoc</a>]</span>, we reduce the number of mandatory messages, from 5 to 4, and again we obtain a tradeoff between the size of messages, calculation capabilities, and the number of messages.<a href="#section-3.5.5-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-4">
      <h2 id="name-security-considerations">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-4-1">TODO Security<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="security-considerations-of-pq-edhoc-ikr-i-signs-r-kem">
<section id="section-4.1">
        <h3 id="name-security-considerations-of-">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-security-considerations-of-" class="section-name selfRef">Security Considerations of PQ-EDHOC-IKR (I Signs - R KEM)</a>
      </h3>
</section>
</div>
<div id="security-considerations-of-pq-edhoc-kem-andor-sign">
<section id="section-4.2">
        <h3 id="name-security-considerations-of-p">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-security-considerations-of-p" class="section-name selfRef">Security Considerations of PQ-EDHOC KEM and/or Sign</a>
        </h3>
<div id="initiator-signs-and-responder-kem-signs">
<section id="section-4.2.1">
          <h4 id="name-initiator-signs-and-respond">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-initiator-signs-and-respond" class="section-name selfRef">Initiator signs and Responder KEM &amp; Signs</a>
        </h4>
</section>
</div>
<div id="initiator-kem-signs-and-responder-signs">
<section id="section-4.2.2">
          <h4 id="name-initiator-kem-signs-and-res">
<a href="#section-4.2.2" class="section-number selfRef">4.2.2. </a><a href="#name-initiator-kem-signs-and-res" class="section-name selfRef">Initiator KEM &amp; Signs and Responder Signs</a>
        </h4>
</section>
</div>
<div id="initiator-kem-signs-and-responder-kem">
<section id="section-4.2.3">
          <h4 id="name-initiator-kem-signs-and-resp">
<a href="#section-4.2.3" class="section-number selfRef">4.2.3. </a><a href="#name-initiator-kem-signs-and-resp" class="section-name selfRef">Initiator KEM &amp; Signs and Responder KEM</a>
        </h4>
</section>
</div>
<div id="initiator-and-responder-kem-signs">
<section id="section-4.2.4">
          <h4 id="name-initiator-and-responder-kem">
<a href="#section-4.2.4" class="section-number selfRef">4.2.4. </a><a href="#name-initiator-and-responder-kem" class="section-name selfRef">Initiator and Responder KEM &amp; Signs</a>
        </h4>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-5">
      <h2 id="name-iana-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-5-1">This document has no IANA actions.<a href="#section-5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="acknowledgments">
<section id="section-6">
      <h2 id="name-acknowledgments">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-6-1">TODO acknowledge.<a href="#section-6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-combined-references">
<section id="section-7">
      <h2 id="name-references">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-7.1">
        <h3 id="name-normative-references">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.pocero-authkem-edhoc">[I-D.pocero-authkem-edhoc]</dt>
        <dd>
<span class="refAuthor">Fraile, L. P.</span>, <span class="refAuthor">Koulamas, C.</span>, <span class="refAuthor">Fournaris, A. P.</span>, and <span class="refAuthor">E. Haleplidis</span>, <span class="refTitle">"KEM-based Authentication for EDHOC"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-pocero-authkem-edhoc-01</span>, <time datetime="2025-10-24" class="refDate">24 October 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-pocero-authkem-edhoc-01">https://datatracker.ietf.org/doc/html/draft-pocero-authkem-edhoc-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.pocero-authkem-ikr-edhoc">[I-D.pocero-authkem-ikr-edhoc]</dt>
        <dd>
<span class="refAuthor">Fraile, L. P.</span>, <span class="refAuthor">Koulamas, C.</span>, <span class="refAuthor">Fournaris, A. P.</span>, and <span class="refAuthor">E. Haleplidis</span>, <span class="refTitle">"KEM-based Authentication for EDHOC in Initiator-Known Responder (IKR) Scenarios"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-pocero-authkem-ikr-edhoc-01</span>, <time datetime="2026-01-20" class="refDate">20 January 2026</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-pocero-authkem-ikr-edhoc-01">https://datatracker.ietf.org/doc/html/draft-pocero-authkem-ikr-edhoc-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.spm-lake-pqsuites">[I-D.spm-lake-pqsuites]</dt>
        <dd>
<span class="refAuthor">Selander, G.</span> and <span class="refAuthor">J. P. Mattsson</span>, <span class="refTitle">"Quantum-Resistant Cipher Suites for EDHOC"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-spm-lake-pqsuites-01</span>, <time datetime="2025-10-20" class="refDate">20 October 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-spm-lake-pqsuites-01">https://datatracker.ietf.org/doc/html/draft-spm-lake-pqsuites-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5116">[RFC5116]</dt>
        <dd>
<span class="refAuthor">McGrew, D.</span>, <span class="refTitle">"An Interface and Algorithms for Authenticated Encryption"</span>, <span class="seriesInfo">RFC 5116</span>, <span class="seriesInfo">DOI 10.17487/RFC5116</span>, <time datetime="2008-01" class="refDate">January 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5116">https://www.rfc-editor.org/rfc/rfc5116</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8392">[RFC8392]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"CBOR Web Token (CWT)"</span>, <span class="seriesInfo">RFC 8392</span>, <span class="seriesInfo">DOI 10.17487/RFC8392</span>, <time datetime="2018-05" class="refDate">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8392">https://www.rfc-editor.org/rfc/rfc8392</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8742">[RFC8742]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR) Sequences"</span>, <span class="seriesInfo">RFC 8742</span>, <span class="seriesInfo">DOI 10.17487/RFC8742</span>, <time datetime="2020-02" class="refDate">February 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8742">https://www.rfc-editor.org/rfc/rfc8742</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8949">[RFC8949]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">STD 94</span>, <span class="seriesInfo">RFC 8949</span>, <span class="seriesInfo">DOI 10.17487/RFC8949</span>, <time datetime="2020-12" class="refDate">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8949">https://www.rfc-editor.org/rfc/rfc8949</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9052">[RFC9052]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Structures and Process"</span>, <span class="seriesInfo">STD 96</span>, <span class="seriesInfo">RFC 9052</span>, <span class="seriesInfo">DOI 10.17487/RFC9052</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9052">https://www.rfc-editor.org/rfc/rfc9052</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9360">[RFC9360]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Header Parameters for Carrying and Referencing X.509 Certificates"</span>, <span class="seriesInfo">RFC 9360</span>, <span class="seriesInfo">DOI 10.17487/RFC9360</span>, <time datetime="2023-02" class="refDate">February 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9360">https://www.rfc-editor.org/rfc/rfc9360</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9528">[RFC9528]</dt>
      <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Preuß Mattsson, J.</span>, and <span class="refAuthor">F. Palombini</span>, <span class="refTitle">"Ephemeral Diffie-Hellman Over COSE (EDHOC)"</span>, <span class="seriesInfo">RFC 9528</span>, <span class="seriesInfo">DOI 10.17487/RFC9528</span>, <time datetime="2024-03" class="refDate">March 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9528">https://www.rfc-editor.org/rfc/rfc9528</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-7.2">
        <h3 id="name-informative-references">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC9053">[RFC9053]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Initial Algorithms"</span>, <span class="seriesInfo">RFC 9053</span>, <span class="seriesInfo">DOI 10.17487/RFC9053</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9053">https://www.rfc-editor.org/rfc/rfc9053</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9794">[RFC9794]</dt>
      <dd>
<span class="refAuthor">Driscoll, F.</span>, <span class="refAuthor">Parsons, M.</span>, and <span class="refAuthor">B. Hale</span>, <span class="refTitle">"Terminology for Post-Quantum Traditional Hybrid Schemes"</span>, <span class="seriesInfo">RFC 9794</span>, <span class="seriesInfo">DOI 10.17487/RFC9794</span>, <time datetime="2025-06" class="refDate">June 2025</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9794">https://www.rfc-editor.org/rfc/rfc9794</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-A">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Clément Papon</span></div>
<div dir="auto" class="left"><span class="org">XLIM UMR CNRS 7252 - Limoges University</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:clement.papon@unilim.fr" class="email">clement.papon@unilim.fr</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Cristina Onete</span></div>
<div dir="auto" class="left"><span class="org">XLIM UMR CNRS 7252 - Limoges University</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:maria-cristina.onete@unilim.fr" class="email">maria-cristina.onete@unilim.fr</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
